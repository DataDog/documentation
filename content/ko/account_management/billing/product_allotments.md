---
title: 제품 할당
---

선택한 상위 제품 구독에 따라 할당 서비스를 이용할 수 있습니다. 계정 전용 상위 제품의 온디맨드 사용량의 일부를 하위 제품에 할당할 수 있습니다.

이와 같은 구조가 있는 제품 예시로는 인프라스트럭처 호스트, 컨테이너가 있습니다. 이들 제품의 경우 각 호스트에 컨테이너 할당 기능이 포함되어 있습니다.

## 요금 계산 내 할당

총 사용량은 청구와 비청구 사용량으로 나뉩니다. 청구 사용량은 계장에 청구되는 사용량이며, 비청구 사용량은 청구되지 않는 사용량입니다. 비청구 사용량에는 평가판 사용량 등이 있습니다.

청구 사용량 인보이스를 생성할 때 먼저 총 사용량에서 포함된 사용량을 뺍니다. 할당은 포함된 사용량에 반영된 다음 청구 사용량에서 온디맨드 사용량을 계산하는 데 사용됩니다.

- `할당 + 약정 사용량 = 포함된 사용량`
- `청구 사용량 - 포함된 사용량 = 온디멘드 사용량`

예를 들어, 총 수집된 스팬 사용량이 150 GB인 계정이 있다고 합시다. 여기에서 140 GB가 청구 사용량입니다. 50 GB를 사전에 약정하고 할당이 30 GB라고 하면, 이 80 GB 사용량이 포함된 사용량입니다. 140 GB에서 이 포함된 사용량 80 GB를 뺀 값인 60 GB 사용량이 온디맨드 사용량입니다.

- 총 사용량과 청구 사용량을 보려면 Datadog의 [**Plan and Usage** 페이지][2] 내에서 **All**과 **Billable** 탭을 확인하세요.
- 약정 사용량을 보려면 계약서를 참고하세요.

## 포함된 사용량 계산
총 포함된 사용량은 **제품 약정과 상위 제품별 할당의 합**입니다. 약정 수량은 사용자 계약을 참고하시기 바랍니다. 다음 변수에 따라 할당 사용량 계산이 달라집니다.

- 온디맨드 옵션
- 상위 제품별 할당
- 사용량 집계 함수

### 온디멘드 옵션

제품의 할당 사용량은 조직의 온디맨드 측정 옵션에 따라 계산됩니다. 조직은 **월별 또는 시간별** 온디맨드 옵션 중에서 선택할 수 있습니다. 내 조직의 측정 옵션을 보려면 계약서를 참고하시기 바랍니다.

기본적으로 온디맨드 옵션은 구독 수준에 따라 설정되며 다음 제품을 제외한 모든 제품에 적용됩니다. 다음 제품은 기본 온디맨드 옵션 하나만 지원합니다.

| 제품                                         | 기본 옵션 |
|-------------------------------------------------|----------------|
| 컨테이너(인프라스트럭처, 프로필, 보안) | 시간별         |
| 인시던트 관리                             | 월별        |
| APM Fargate 제품                            | 월별        |
| 서버리스 APM                                  | 월별        |
| 로그 제품                                   | 월별        |
| SNMP Traps                                      | 월별        |

시간별 측정의 경우, 월별 할당은 시간별 할당으로 조정됩니다. APM 스팬과 같은 합산 제품의 경우, 월별 할당을 먼저 연간화하고 연간 시간 수로 나누어 시간별 할당을 산출합니다. 커스텀 메트릭과 같은 평균 계산 제품의 경우, 월별 총 사용량이 월 전체 시간의 청구 사용량 평균이므로, 온디맨드 옵션에 관계없이 월별 할당이 적용됩니다.

## 상위 제품별 할당

상위 제품별 기본 할당의 전체 목록을 보려면 [할당량 계산기][3] 페이지의 할당량 표를 참고하세요. 커스텀 또는 기본값이 아닌 할당량의 경우 계약서를 참고하시기 바랍니다.

조직 상위 제품의 청구 사용량이 약정 사용량을 초과하는 경우 온디맨드 상위 제품 사용량에서 추가 할당을 받을 수 있고, 이 사용량은 상위 제품에만 청구됩니다. 이 추가 사용량도 모두 소진하고 하위 제품에서 사용한 추가 사용량은 온디맨드 가격으로 청구됩니다. 온디맨드 옵션과 관계없이 할당량은 다음 시간으로 이월되지 않습니다. 월별 또는 시간별 측정 기간에 남은 사용량이 있더라도 다음 기간에 적용할 수 없습니다.

예를 들어, 월별 온디맨드 옵션을 선택한 조직이 APM 프로 호스트 5개 약정을 맺고 기본 수집 스팬 할당량이 월별 `5 APM 프로 호스트 * 호스트당 150 GB 수집 스팬`이라고 합시다. 만약 이 조직에서 APM 호스트 6개와 800 GB의 수집 스팬을 사용할 경우, 추가 호스트 사용량에 대해서는 청구를 하지만 추가 _스팬_ 사용량에 대해서는 청구하지 않습니다. 왜냐하면 수집 스팬 할당량이 900 GB로 늘어나기 때문입니다. 사용하지 않은 100 GB는 다음 달로 이월되지 않습니다.

## 사용량 집계 함수
집계 함수는 요금을 청구할 때 시간별 청구 사용량을 월별 사용량 값으로 전환할 때 사용됩니다. 각 제품에는 최대 2개의 사용량 집계 함수가 있습니다(각 온디맨드 옵션에 하나씩). 이용 가능한 집계 함수에는 합계, 평균, 최댓값, HWMP(High Watermark Plan)이 있습니다.

- 해당 월의 모든 시간대에 걸친 총 사용량의 합계입니다. 사용량은 매시간 계산되며, 각각의 개별 제품 사용 건에 포함된 사용량과 청구 사용량을 비교하여 산정됩니다. 월말에는 해당 월의 각 시간대별 온디맨드 사용량이 모두 합산됩니다.
- **평균:** 월별 온디맨드 옵션의 경우, 해당 월의 모든 시간대에 걸친 평균 사용량입니다. 해당 월의 온디맨드 사용량은 해당 월의 평균 사용량에서 총 포함된 사용량을 차감하여 산출합니다.

   시간별 온디맨드 옵션의 경우, 사용량은 각 시간별로 측정된 후, 각 시간별로 측정된 사용량에서 총 포함된 사용량을 차감하여 각 시간별 온디맨드 사용량을 산출합니다. 월말에는 모든 시간대의 온디맨드 사용량을 합산한 후 해당 월의 시간 수로 나누어 평균을 계산합니다.
- **최댓값:** 주어진 기간(일반적으로 한 달) 동안 모든 시간 구간에서 발생한 최대 사용량입니다.
- **HWMP(High Watermark Plan):** 청구 가능한 호스트 수가 해당 시간 동안 사용량 중 하위 99%의 최댓값 수를 사용하여 월말에 계산됩니다. Datadog은 사용량 급증이 청구서에 미치는 영향을 줄이기 위해 상위 1%를 제외합니다.

각 제품별 상세 내용을 보려면 [할당용 사용량 집계 함수](#usage-aggregation-functions-for-allotments)를 참고하세요.

## 온디맨드 사용량 계산

온디맨드 사용량이란 약정 및 할당 사용량을 넘어서는 사용량의 누적 합계입니다. 온디맨드 사용량은 **청구 사용량**에서 **포함된 사용량**(약정되고 할당된 사용량)을 차감하여 계산합니다.

온디맨드 옵션은 온디맨드 사용량을 계산하는 방법을 결정합니다. 월별 온디맨드 옵션의 경우 월말에 온디맨드 사용량이 계산됩니다. 시간별 온디맨드 옵션의 경우, 한 시간마다 온디맨드 사용량이 계산되고, 해당 월의 모든 시간대의 시간별 온디맨드 사용량의 누적 합계가 총 온디맨드 사용량으로 월말에 청구됩니다.

### 예시
**월별 온디맨드 옵션을 선택한 조직**이 APM 프로 호스트 5개와 수집 스팬 0으로 약정을 맺었다고 합시다. 이 조직의 총 포함된 사용량은 `(APM 프로 호스트 5개 * 호스트당 수집 스팬 150 GB) + 0 약정 =  총 포함된 사용량의 수집 스팬 750 GB`입니다. 만약 수집 스팬 사용량이 1,000 GB일 경우, 추가 250 GB가 온디맨드 사용량이 됩니다.

**시간별 온디맨드 옵션을 선택한 조직**이 APM 프로 호스트 5개와 수집 스팬 0으로 약정을 맺었다고 합시다. 이 조직의 온디맨드 사용량은 시간별로 계산되기 때문에, 월별 할당을 연간화한 후 1년의 시간 수로 나눕니다(`(365 * 24 / 12) = 730`). 따라서 시간별 수집 스팬 할당량은 `(APM 호스트 5개 * (호스트 당 수집 스팬 150 GB) / (730시간)) = 시간별 수집 스팬 1.027 GB`입니다.

이 조직에서 만약 시간 1에 1.1 GB, 시간 2에 0.9 GB, 시간 3에1.2 GB를 사용했다면, 해당 월의 온디맨드 사용량은 해당 월 전체 시간의 청구 사용량에서 할당된 사용량을 뺀 차이의 합계입니다(`(1.1 - 1.027 = 0.073) + (0.9 - 1.027 = 0) + (1.2 - 1.027 = 0.173) = 수집 스팬 온디맨드 사용량 0.246 GB`).

## 청구 사용량 계산

청구 사용량은 사용자 인보이스에 표시되는 원시 사용량을 뜻하며, 조직과 제품 평가판 사용량은 제외됩니다. 내 청구 사용량을 보려면 Datadog의 [플랜 및 사용량 페이지][2]를 참조하시기 바랍니다. 청구 사용량 계산은 다음 변수에 따라 결정됩니다.

- 온디멘드 옵션
- 사용량 집계 함수

### 온디멘드 옵션
월별 측정 방법의 경우, 월말에 청구 사용량을 포함된 사용량에 비교하여 온디맨드 사용량을 계산합니다. 시간별 측정 방법의 경우에는 월말이 아니라 매 시간마다 온디맨드 사용량을 계산합니다. 그 후 해당 월의 총 사용 시간을 누적 집계하고 약정을 적용하여  청구 가능한 온디맨드 사용량 값을 최종적으로 산출합니다.

### 사용량 집계
[사용량 집계 함수](#usage-aggregation-function)를 참고하세요.

### 예시

#### 월별 온디맨드 옵션

APM 프로 호스트 10개와 수집 스팬 100 GB의 월별 약정을 3개월간 맺은 조직이 있다고 합시다. 이 조직의 사용량은 다음과 같습니다(산출된 값은 *기울임* 표시).

| 월 | APM 호스트 약정 | APM 호스트 사용량 | 수집 스팬 할당량 | 수집 스팬에 포함된 사용량 | 수집 스팬 청구 사용량 | 수집 스팬 온디맨드 사용량 |
|-----|--------|--------|-----------|-----------|---------|---|
| 1  | 10  | 5   | *1,500 GB*   | *1,600 GB*   | 2,000 GB | *400 GB*  |
| 2  | 10  | 15 | *2,250 GB*  | *2,350 GB* | 2,000 GB  | *0 GB*      |
| 3 | 10   | 10   | *1,500 GB*  | *1,600 GB*  | 1,600 GB | *0 GB*  |

월별 온디맨드 옵션의 경우, 각  APM 프로 호스트당 수집 스팬의 [기본 할당량](#allotments-table)은 150 GB입니다.

**첫 달**의 경우, APM 호스트 10개를 약정했는데 5개만 사용했습니다. 수집 스팬 할당량은 호스트 약정과 호스트 사용량 중 더 큰 값에 기본 할당량을 곱한 값입니다(`maximum(5, 10) * 150 GB = 수집 스팬 할당량 1,500 GB`). 수집 스팬의 포함된 사용량은 약정과 할당량의 합(`1,500 GB + 100 GB = 1,600 GB`)입니다. 수집 스팬의 온디맨드 사용량은 청구 사용량에서 할당량을 뺀 차이와 0 중 큰 값(`maximum(0, 2,000 - 1,600) = 400 GB`)입니다.

**두 번째 달**의 경우, APM 호스트 10개를 약정했는데 15개를 사용했습니다. 수집 스팬 할당량은 호스트 약정과 호스트 사용량 중 더 큰 값에 기본 할당량을 곱한 값입니다(`maximum(15, 10) * 150 GB = 수집 스팬 할당량 2,250 GB`). 수집 스팬의 포함된 사용량은 약정과 할당량의 합(`2,250 GB + 100 GB = 2,350 GB`)입니다. 수집 스팬의 온디맨드 사용량은 사용량에서 할당량을 뺀 차이와 0 중 큰 값(`maximum(0, 2,000 - 2,350) = 0 GB`)입니다.

**세 번째 달**의 경우, APM 호스트 10개를 약정했는데 10개를 모두 사용했습니다. 수집 스팬 할당량은 호스트 약정과 호스트 사용량 중 더 큰 값에 기본 할당량을 곱한 값입니다(`maximum(10, 10) * 150 GB = 수집 스팬 할당량 1,500 GB`). 수집 스팬의 포함된 사용량은 약정과 할당량의 합(`1,500 GB + 100 GB = 1,600 GB`)입니다. 수집 스팬의 온디맨드 사용량은 사용량에서 할당량을 뺀 차이와 0 중 큰 값(`maximum(0, 1,600 - 1,600) = 0 GB`)입니다.

#### 시간별 온디맨드 옵션

APM 프로 호스트 10개와 수집 스팬 0.3 GB의 월별 약정을 1개월간 맺은 조직이 있다고 합시다. 이 조직의 사용량은 다음과 같습니다.

| 타임스탬프    | APM 호스트 약정 | APM 호스트 사용량 | 수집 스팬 할당량 | 수집 스팬 사용량 | 온디맨드 수집 스팬 사용량 |
|--------------|---------------------|----------------|--------------------------|----------------------|--------------------------------|
| 시간 1 | 10    | 5      | 2.054 GB     | 2.500 GB    | 0.446 GB           |
| 시간 2 | 10    | 15     | 3.082 GB     | 3.000 GB    | 0 GB               |
| 시간 3 | 10    | 10     | 2.054 GB     | 2.054 GB    | 0 GB               |

시간별 온디맨드 옵션의 경우, 각  APM 프로 호스트당 수집 스팬의 [기본 할당량](#allotments-table)은 0.2054 GB입니다.

**시간 1**의 경우, APM 호스트 10개를 약정했는데 5개만 사용했습니다. 시간별 수집 스팬 할당량은 호스트 약정과 호스트 사용량 중 더 큰 값에 기본 할당량을 곱한 값입니다(`maximum(5, 10) * 0.2054 GB = 시간당 2.504 GB`). 해당 시간의 온디맨드 사용량은 청구 사용량에서 할당량을 뺀 차이와 0 중 큰 값(`maximum(0, 2.500 - 2.054) = 0.446 GB`)입니다.

**시간 2**의 경우, APM 호스트 10개를 약정했는데 15개를 사용했습니다. 시간별 수집 스팬 할당량은 호스트 약정과 호스트 사용량 중 더 큰 값에 기본 할당량을 곱한 값입니다(`maximum(15, 10) * 0.2054 GB = 시간당 3.081 GB`). 해당 시간의 온디맨드 사용량은 청구 사용량에서 할당량을 뺀 차이와 0 중 큰 값(`maximum(0, 3.000 - 3.081) = 0 GB`)입니다.

**시간 3**의 경우, APM 호스트 10개를 약정했고 10개를 사용했습니다. 시간별 수집 스팬 할당량은 호스트 약정과 호스트 사용량 중 더 큰 값에 기본 할당량을 곱한 값입니다(`maximum(10, 10) * 0.2054 GB = 시간당 2.054 GB`). 해당 시간의 온디맨드 사용량은 청구 사용량에서 할당량을 뺀 차이와 0 중 큰 값(`maximum(0, 2.054 - 2.054) = 0 GB`)입니다.

수집 스팬의 기본 사용량 누적 함수가 합계이므로, 해당 월의 모든 시간의 사용량을 합산하여 해당 월의 총 온디맨드 사용량을 구합니다. 만약 이 조직에서 해당 월에 수집 스팬 사용 시간이 3시간이라면, 총 월별 사용량은 0입니다(`4452 + 0 + 0 = 0.446 GB`).

또한 이 조직은 수집 스팬 0.3 GB의 월별 약정을 맺었습니다.  따라서 월별 온디맨드 사용량은 0과 월별 사용량 및 약정의 차 중 더 큰 값이 됩니다(`maximum(0, 0.446 – 0.3) = 0.146 GB`).

## 할당량 사용량 집계 함수

| 할당량             | 가능한 상위 제품                                      | 기본 월별 사용량 집계 함수 | 기본 시간당 사용량 집계 함수 |
|-----------------------|---------------------------------------------------------------|--------------------------------------------|-------------------------------------------|
| 커스텀 메트릭 | 인프라스트럭처 프로 호스트, 인프라스트럭처 프로 플러스 호스트, 인프라스트럭처 엔터프라이즈 호스트, IoT(Internet of Things),  서버리스 워크로드 모니터링 - 함수, 서버리스 워크로드 모니터링 - 앱, 서버리스 인보케이션, 서버리스 함수  | 평균 | 평균 |
| 수집된 커스텀 메트릭 | 인프라스트럭처 프로 호스트, 인프라스트럭처 프로 플러스 호스트, 인프라스트럭처 엔터프라이즈 호스트, IoT(Internet of Things),  서버리스 워크로드 모니터링 - 함수, 서버리스 워크로드 모니터링 - 앱 | 평균 | 평균 |
| 커스텀 이벤트 | 인프라스트럭처 프로 호스트, 인프라스트럭처 프로 플러스 호스트, 인프라스트럭처 엔터프라이즈 호스트 | 합계 | 합계 |
| CSM 엔터프라이즈 컨테이너    | CSM(클라우드 보안 관리)       |      N/A     | 합계    |
| CWS 컨테이너      | CWS(클라우드 워크로드 보안)              |       N/A     | 합계      |
| 인프라스트럭처 컨테이너    | 인프라스트럭처 프로 호스트, 인프라스트럭처 프로 플러스 호스트, 인프라스트럭처 엔터프라이즈 호스트 |   N/A   | 합계  |
| 프로파일링된 컨테이너 | APM 엔터프라이즈, 지속적 프로파일러    |   N/A        | 합계   |
| 프로파일링 호스트        | APM 엔터프라이즈       | HWMP   | 합계     |
| CI 인덱싱된 스팬    | CI 가시성         | 합계     | 합계   |      
| 인덱싱된 스팬 테스트    | 테스트 최적화         | 합계   | 합계   |               
| APM 인덱싱된 스팬 | APM, APM 프로, APM 엔터프라이즈, 서버리스 APM, </br> 레거시 - 서버리스 인보케이션, </br> 레거시 - 서버리스 함수, Fargate Task(APM 프로), </br> Fargate Task(APM 엔터프라이즈) | 합계 | 합계 |
| APM 수집된 스팬 | APM, APM 프로, APM 엔터프라이즈 </br> 서버리스 APM, 레거시 - 서버리스 인보케이션 </br> 레거시 - 서버리스 함수 </br> Fargate Task(APM 프로), Fargate Task(APM 엔터프라이즈) | 합계 | 합계 | 
| DBM 표준화된 쿼리 | DBM(데이터베이스 모니터링) | 평균 | 평균 |
| 데이터 스트림 모니터링 | APM 프로, APM 엔터프라이즈 | HWMP | 합계 |
| CSPM 워크플로우 실행 | 클라우드 보안 관리 프로, 클라우드 보안 관리 엔터프라이즈 | 합계 | 합계 |
| Fargate Task(지속적 프로파일러) | Fargate Task(APM 엔터프라이즈) | 평균 | N/A |

[1]: https://www.datadoghq.com/pricing/list/
[2]: https://app.datadoghq.com/billing/usage
[3]: https://www.datadoghq.com/pricing/allotments/