---
aliases:
- /ko/tracing/trace_explorer/facets
description: 스팬 패싯 및 패싯 패널
further_reading:
- link: tracing/trace_explorer/
  tag: 설명서
  text: Trace Explorer란?
title: 스팬 태그, 속성, 패싯
---

## 개요

스팬 메타데이터는 **속성**과 **태그**로 구성됩니다.

* **[스팬 속성](#span-attributes)**은 애플리케이션에서 자동 또는 수동 계측을 통해 수집된 스팬의 콘텐츠입니다.

* **[스팬 태그](#span-tags)**는 스팬과 관련된 컨텍스트를 보강해주는 태그입니다 (예: 서비스가 실행 중인 인프라를 설명하는 호스트나 컨테이너 태그).

[Trace Explorer][6]에서 모든 스팬 태그와 속성을 통해 스팬을 쿼리할 수 있습니다.

### 예약된 속성

예약된 속성은 모든 스팬에 존재하는 스팬 속성의 하위 집합입니다. 이러한 속성은 `@` 문자를 앞에 붙이지 않고도 쿼리할 수 있습니다. 예약된 속성의 전체 목록은 `env`, `service`, `operation_name`, `resource_name`, `status`, `ingestion_reason`, `trace_id`입니다. 용어의 전체 정의는 [APM 용어 및 개념][10]을 참고하세요.

### 스팬(span) 속성

스팬 속성은 스팬의 콘텐츠입니다. 이러한 속성은 자동 계측을 사용하여 추적 라이브러리에서 기본적으로 수집되거나, 사용자 지정 계측을 사용하여 수동으로 수집되거나, 소스 속성([피어 속성][11] 참고, 일부 소스 속성에서 재매핑됨)을 기반으로 Datadog 백엔드에서 재매핑됩니다. 특정 스팬 속성을 검색하려면 속성 키의 시작 부분에 `@` 문자를 추가해야 합니다.

예를 들어, postgres 데이터베이스에서 `users` 테이블 호출을 나타내는 스팬을 찾으려면 `@peer.db.name:users @peer.db.system:postgres` 쿼리를 사용합니다.

### 스팬(span) 태그

스팬 태그는 스팬을 둘러싼 컨텍스트이며, 스팬이 생성된 서비스가 실행되고 있는 호스트 또는 컨테이너를 기반으로 보강된 데이터입니다. 스팬 태그를 쿼리하기 위해 `@` 문자를 추가할 필요가 없습니다.

## 패싯

스팬 태그와 속성 위에 **패싯**을 만들어 속성을 올바른 유형(예: 문자열 또는 정수)에 매핑하고 이러한 속성이 패싯 목록에 표시되도록 할 수 있습니다.

**참고**: [스팬 검색][7], [스팬에서 메트릭 생성][8], [보존 필터를 사용하여 스팬을 인덱싱][9]하는 작업에서는 [패싯 생성](#creating-facets)이 **필요하지 않습니다**.

{{< img src="tracing/trace_explorer/facets/facet_panel.png" alt="Trace Explorer의 패싯 패널" style="width:90%;">}}

### 정성적 패싯

다음의 경우 정성적 패싯을 사용하세요.

- 값에 대한 **인사이트**를 얻으세요. 예를 들어, 느린 요청이 감지되면 조사 범위를 특정 지역으로 좁히기 위해 `datacenter` 스팬 태그에 패싯을 생성합니다.
- **고유한 값을 계산합니다**. 예를 들어 특정 리소스를 로드하는 동안 오류가 발생하는 개별 사용자 수를 확인하려면 `usr.email`에 패싯을 생성합니다.
- 특정 값을 기준으로 스팬을 자주 **필터링**하세요. 예를 들어 환경 태그에 패싯을 생성하여 문제 해결 범위를 개발, 스테이징 또는 프로덕션 환경까지 확장할 수 있습니다.<br>

**참고:** 태그 필터링에는 패싯이 필요하지 않지만 조사 중에 자주 사용하는 태그에 대한 패싯을 정의하면 해결 시간을 줄이는 데 도움이 될 수 있습니다.

### 정량적 패싯(측정값)

다음의 경우 측정값을 사용하세요.
- 여러 추적의 **집계** 값입니다. 예를 들어 Cassandra의 행 수에 대한 측정값을 만들고 요청된 파일 크기 합계당 p95 또는 최상위 리퍼러를 확인합니다.
- 예를 들어 $1000가 넘는 장바구니 값에 대해 **가장 높은 지연 시간 서비스**를 수치적으로 계산합니다.
- **연속 값을 필터링**합니다(예: 비디오 스트림의 각 페이로드 청크 크기(바이트)).

#### 측정값 유형

측정값은 동등한 기능에 대해 (큰) 정수 또는 이중 값을 갖습니다.

#### 단위

측정값은 쿼리 시간 및 표시 시간에서 자릿수를 처리하기 위한 단위(초 단위의 **시간** 또는 바이트 단위의 **크기**)를 지원합니다. 단위는 필드가 아닌 측정값 자체의 속성입니다.

예를 들어 나노초 단위의 `duration` 측정값을 고려해보세요. `service:A`의 스팬이 `1000 milliseconds`를 의미하는 `duration:1000`를 가지고 있다고 가정해 봅시다. 또한, `service:B`의 스팬이 `500 microseconds`를 의미하는 `duration:500`을 가지고 있습니다. 두 서비스 모두에서 일관되게 그리고 한번에 스팬 태그를 쿼리하기 위해 `duration:>20ms`를 사용해야 합니다. 쿼리에 대한 자세한 정보는 [쿼리 구문][1]을 참조하세요.

## 패싯 패널

검색창은 데이터를 필터링하고 그룹화하기 위한 가장 포괄적인 상호 작용 세트를 제공합니다. 그러나 대부분의 경우 패싯 패널은 데이터를 탐색하는 간단한 방법입니다. 현재 쿼리 범위에 대한 콘텐츠 요약을 보려면 패싯을 엽니다.

검색 창과 URL은 패싯 패널의 선택 사항을 자동으로 반영합니다.

- **패싯(정성적)**에는 고유 값의 상위 목록과 각 값과 일치하는 스팬 수가 제공됩니다.
- **측정값(정량적)**에는 최소값과 최대값을 나타내는 슬라이더가 함께 제공됩니다. 슬라이더를 사용하거나 숫자 값을 입력하여 검색 쿼리 범위를 다른 범위로 지정하세요.

### 패싯 숨기기

조직에는 트레이스를 사용하는 다양한 팀의 사용 사례를 처리해야 하는 많은 패싯이 있습니다. 특정 상황에서는 이러한 패싯 중 일부만 유용할 가능성이 높습니다.

문제 해결과 가장 관련 있는 패싯만 유지하려면 필요하지 않은 **패싯을 숨깁니다**.

{{< img src="tracing/trace_explorer/facets/hide_facets.png" alt="패싯 숨김t" style="width:30%;">}}

필요한 경우 숨겨진 패싯이 패싯 검색에 계속 표시됩니다([필터 패싯](#filtering-facets) 섹션 참조). 패싯 검색에서 숨겨진 패싯을 숨김 해제합니다.

{{< img src="logs/explorer/facet/unhide_facet.png" alt="패싯 숨김 해제" style="width:30%;">}}

#### 숨겨진 패싯 및 팀 구성원

패싯을 숨기는 것은 문제 해결 상황에 따라 다르며 저장된 보기를 업데이트하지 않는 한 팀원의 보기에 영향을 주지 않습니다. 숨겨진 패싯은 저장된 보기에 저장된 컨텍스트의 일부입니다.

### 패싯 그룹화

패싯은 패싯 목록에서 의미 있는 테마로 그룹화됩니다. 패싯에 대한 그룹을 할당하거나 재할당하면 패싯 목록에만 영향을 미치며 검색이나 분석에는 영향을 미치지 않습니다.

{{< img src="tracing/trace_explorer/facets/group_facets.png" alt="그룹 패싯" style="width:30%;">}}

### 패싯 필터링

패싯 패널의 검색 패싯 상자를 사용하면 전체 패싯 목록의 범위를 지정하고 상호 작용해야 하는 패싯으로 더 빠르게 이동할 수 있습니다. 검색 패싯은 패싯 표시 이름과 필드 이름을 사용하여 결과 범위를 지정합니다.

{{< img src="tracing/trace_explorer/facets/filter_facets.png" alt="검색 패싯" style="width:30%;">}}

## 패싯 생성

스팬 속성/태그에 패싯을 생성하는 것은 스팬 검색을 위한 필수 단계가 아닙니다. 패싯은 특정 스팬 속성에 의미 있는 설명을 추가하려는 경우 또는 스팬 목록의 왼쪽에 있는 패싯 목록에 스팬 속성 값을 표시하려는 경우에 유용합니다.

### 트레이스 사이드 패널에서 패싯 생성

패싯을 생성하는 가장 쉬운 방법은 대부분의 패싯 세부 정보(예: 필드 경로 및 기본 유형)가 미리 채워지도록 트레이스 사이드 패널에서 패싯을 추가하는 것입니다. [Trace Explorer][1]에서 패싯을 생성할 필드가 포함된 관심 스팬으로 이동합니다. 목록에서 스팬을 선택하여 이 스팬에 대한 트레이스 사이드 패널을 엽니다. 원하는 필드(스팬 태그 또는 인프라스트럭처 태그)를 클릭하고 거기에서 패싯을 생성합니다.

- 필드에 숫자 값이 있는 경우 패싯 또는 측정값을 생성할 수 있습니다.
- 필드에 문자열 값이 있는 경우 패싯 생성만 사용할 수 있습니다.

{{< img src="tracing/trace_explorer/facets/create_facet.png" alt="태그에서 패싯 추가" style="width:50%;">}}

### 패싯 목록에서 패싯 생성

원하는 필드가 있는 스팬을 찾을 수 없는 경우 **+ Add**를 클릭하여 패싯 패널에서 직접 패싯을 생성합니다.

이 패싯의 기본 필드(키) 이름을 정의하세요.

- 인프라스트럭처 태그에는 태그 키 이름을 사용합니다.
- `@` 접두사가 있는 스팬 속성의 속성 경로를 사용합니다.

현재 보기 스팬의 콘텐츠를 기반으로 한 자동 완성은 적절한 필드 이름을 정의하는 데 도움이 됩니다. 그러나 여기서는 거의 모든 값을 사용할 수 있습니다. 특히 아직 Datadog에서 수신한 일치하는 스팬이 없는 경우에는 더욱 그렇습니다.

{{< img src="tracing/trace_explorer/facets/create_facet_from_scratch.png" alt="처음부터 패싯 추가" style="width:30%;">}}

## 참고 자료

{{< partial name="whats-next/whats-next.html" >}}

[1]: /ko/tracing/trace_explorer/query_syntax/
[2]: /ko/tracing/trace_explorer/group/
[3]: /ko/monitors/types/apm/?tab=analytics
[4]: /ko/dashboards/widgets/
[5]: /ko/notebooks/
[6]: /ko/tracing/trace_explorer/
[7]: /ko/tracing/trace_explorer/search
[8]: /ko/tracing/trace_pipeline/generate_metrics
[9]: /ko/tracing/trace_pipeline/trace_retention/#retention-filters
[10]: /ko/tracing/glossary
[11]: /ko/tracing/services/inferred_services#peer-tags