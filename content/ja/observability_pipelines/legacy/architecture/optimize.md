---
aliases:
- /ja/observability_pipelines/architecture/optimize/
title: (LEGACY) Optimizing the Instance
---

{{< site-region region="gov" >}}
<div class="alert alert-warning">Observability Pipelines is not available on the US1-FED Datadog site.</div>
{{< /site-region >}}

<div class="alert alert-info">
This guide is for large-scale production-level deployments.
</div>

## インスタンスサイジング

少なくとも 8 つの vCPU と 16 GiB のメモリを持つ最適化されたインスタンスを計算します。これらは、観測可能性パイプラインワーカーアグリゲーターを水平方向に拡張するための理想的なユニットです。観測可能性パイプラインワーカーは、より大きなインスタンスを選択すると、垂直方向にスケールし、自動的に追加リソースを利用することができます。可用性を高めるために、データボリュームに対して少なくとも 2 つの観測可能性パイプラインワーカーインスタンスを使用できるサイズを選択します。

| クラウドプロバイダー| 推奨事項                                        |
| ------------- | ----------------------------------------------------- |
| AWS           | c6i.2xlarge (推奨) または c6g.2xlarge              |
| Azure         | f8                                                    |
| Google Cloud  | c2 (8 vCPU、16 GiB メモリ)                           |
| プライベート       | 8 vCPU、16 GiB メモリ、ローカルディスクは必要ありません |

## CPU サイジング

観測可能性パイプラインワーカーワークロードの多くは、CPU に制約があり、最新の CPU の恩恵を受けることができます。

| クラウドプロバイダー| 推奨事項                                                        |
| ------------- | --------------------------------------------------------------------- |
| AWS           | 最新世代の Intel Xeon、8 vCPU (推奨)、最低 4 vCPU |
| Azure         | 最新世代の Intel Xeon、8 vCPU (推奨)、最低 4 vCPU |
| Google Cloud  | 最新世代の Intel Xeon、8 vCPU (推奨)、最低 4 vCPU |
| プライベート       | 最新世代の Intel Xeon、8 vCPU (推奨)、最低 4 vCPU |

## CPU アーキテクチャ

観測可能性パイプラインワーカーは、最新の CPU アーキテクチャで動作します。X86_64 アーキテクチャは、観測可能性パイプラインワーカーに最も適したパフォーマンスを提供します。

## メモリサイジング

観測可能性パイプラインワーカーのアフィン型システムにより、観測可能性パイプラインワーカーのワークロードでは、メモリが制約されることはほとんどありません。そのため、Datadog は最小で vCPU あたり 2 GiB 以上のメモリを推奨しています。メモリ内バッファリングとバッチ処理により、シンクの数に応じてメモリ使用量が増加します。シンクの数が多い場合は、メモリの増設やディスクバッファへの切り替えを検討してください。

## ディスクサイジング

観測可能性パイプラインワーカーのディスクバッファを使用して高耐久性を実現する場合 (推奨)、vCPU あたり少なくとも 36 GiB のディスクスペースをプロビジョニングします。8 vCPU の推奨に従い、288 GiB のディスク領域をプロビジョニングします (10 MiB * 60 秒 * 60 分 * 8 vCPU)。

| クラウドプロバイダー| 推奨*                                               |
| ------------- | --------------------------------------------------------------|
| AWS           | EBS gp3、vCPU あたり 36 GiB、IOPS およびスループットの追加なし    |
| Azure         | Ultra-disk または標準的な SSD、vCPU あたり 36 GiB                   |
| Google Cloud  | バランス型または SSD の永続ディスク、vCPU あたり 36 GiB             |
| プライベート       | ネットワークベースのブロックストレージ相当、vCPU あたり 36 GiB       |

*推奨サイズは、観測可能性パイプラインワーカーの 10MiB/s/vCPU のスループットで 1 時間計算したものです。例えば、8 vCPU のマシンの場合、288 GiB のディスクスペースが必要です (10 MiB * 60 秒 * 60 分 * 8 vCPU)。

### ディスクタイプ

耐久性と回復のために最適化されたディスクタイプを選択します。例えば、標準的なブロックストレージは、インスタンスから切り離され、複数のディスクにデータをレプリケートして高い耐久性を実現するため、理想的なストレージです。高性能なローカルドライブは、スループットが観測可能性パイプラインワーカーのニーズを上回り、耐久性がブロックストレージに比べて低下するため、推奨されません。

また、Amazon の EFS などのネットワークファイルシステムも使用可能ですが、十分なスループットがプロビジョニングされる場合に限られます。バーストスループットモードでは不十分です。Datadog では、需要が急上昇した場合に備えて余裕を持たせるため、予測される最大スループットの 2 倍の構成にすることを推奨しています。上記の推奨ディスクはどれも十分なスループットを備えているため、この点が問題になることはありません。

このアーキテクチャでディスクが使用される理由については、[データ損失の防止][1]を参照してください。

### オペレーティングシステムと GCC

可能であれば、glibc (GNU) ≧ 2.14 (2011 年リリース) の Linux ベースの OS を選択してください。観測可能性パイプラインワーカーは他のプラットフォームでも動作しますが、この組み合わせが Datadog のベンチマークで最高のパフォーマンスを発揮します。

[1]: /ja/observability_pipelines/legacy/architecture/preventing_data_loss