---
kind: ドキュメント
title: 本番環境のデプロイの概要
---

## 概要

この記事では、観測可能性パイプラインワーカー (OPW) を本番環境にデプロイするためのアーキテクチャのベストプラクティスを説明します。よくあるデプロイの間違いに対する[ガイドライン](#guidelines)、さまざまな観測可能性パイプラインワーカーの[デプロイロール](#deployment-roles)、そして 3 つの[参照アーキテクチャ](#reference-architecture)の概要について説明しています。

## ガイドライン

### 1 つのアグリゲーターから始める

観測可能性パイプラインワーカーのユーザーの多くは、多くのクラスター、サービス、観測可能性ツールからなる複雑な本番環境を持っています。よくある間違いは、1 つのデプロイから始めるのではなく、複数の観測可能性パイプラインワーカーのデプロイを計画することです。Datadog は、1 つの観測可能性パイプラインワーカーアグリゲーターのデプロイから始めて、一度に 1 つのサービスをオンボーディングすることを推奨しています。これにより、より複雑なデプロイメント戦略を採用する前に、迅速にセットアップを行い、観測可能性パイプラインワーカーの運用経験を積むことができます。

 ## デプロイロール

観測可能性パイプラインワーカーは、インフラストラクチャーのどこにでも、Agent またはアグリゲーターとしてデプロイすることができます。

 ### Agent ロール

Agent である観測可能性パイプラインワーカー (OPW) は、個々のノードにデプロイされ、データの収集と処理をエッジにシフトさせます。

{{< img src="observability_pipelines/production_deployment_overview/agent.png" alt="2 つのノードにそれぞれ観測可能性パイプラインワーカーが存在し、ワーカーが中央のコントロールプレーンからデータを受信し、様々なシンクにデータを送信している図" style="width:70%;" >}}

データは、同じノード上の他の Agent (例えば Datadog Agent) から受け取るか、ノード自体から直接収集します (例えば、ログファイルの追跡)。目的は、観測可能性パイプラインワーカーを通してノード上のイグレスを集中化し、活用されていないエッジリソースを利用することです。ほとんどのユーザーは、プロビジョニングされたリソースを増やすことなく、観測可能性パイプラインワーカーを Agent としてデプロイすることができます。

### アグリゲーターロール

観測可能性パイプラインワーカー (OPW) は、専用ノードにスタンドアロンサービスとしてデプロイされ、データの処理とルーティングを専用ノードに移行するアグリゲーターとして利用されます。

{{< img src="observability_pipelines/production_deployment_overview/aggregator_role.png" alt="複数のネットワークロードバランサーからデータを受信し、異なるシンクにデータを送信している複数のワーカーを含む、観測可能性パイプラインワーカーアグリゲーターを示す図" style="width:100%;" >}}

Agent は、観測可能性パイプラインワーカーのアグリゲーターにデータを転送するように構成されています。Datadog では、観測可能性パイプラインワーカーのセットアップが簡単で、どのインフラクチャーにもインテグレーションできるため、観測可能性パイプラインワーカーを始めようとするユーザーにこのロールを推奨しています。

 ## リファレンスアーキテクチャ

この 2 つのデプロイロールがどのようにインフラストラクチャーで機能するかを示す、3 つの一般的なリファレンスアーキテクチャがあります。

 - **アグリゲーターアーキテクチャ (推奨)**: Datadog では、観測可能性パイプラインワーカーの新規ユーザーにこのアーキテクチャを推奨しています。観測可能性パイプラインワーカーを専用のノードにデプロイし、簡単なセットアップと集中処理を実現します。
 - **Agent アーキテクチャ**: このアーキテクチャでは、観測可能性パイプラインワーカーをローカルデータ処理の Agent としてエッジに沿ってデプロイし、利用度の低いエッジリソースを活用します。
 - **統一アーキテクチャ**: このアーキテクチャは、Agent アーキテクチャとアグリゲーターアーキテクチャを組み合わせたものです。Datadog では、アグリゲーターアーキテクチャからスタートした後、このアーキテクチャに進化させることを推奨しています。