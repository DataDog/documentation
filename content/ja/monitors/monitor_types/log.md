---
title: ログモニター
kind: documentation
further_reading:
  - link: /monitors/notifications/
    tag: Documentation
    text: モニター通知の設定
  - link: /monitors/downtimes/
    tag: Documentation
    text: モニターをミュートするダウンタイムのスケジュール
  - link: /monitors/monitor_status/
    tag: Documentation
    text: モニターステータスを確認
---
## 概要

組織で[ログ管理を有効に][1]すると、指定された種類のログが、ユーザー定義のしきい値を一定時間超えた場合にアラートするように、ログモニターを作成することができます。

## モニターの作成

Datadog で[ログモニター][2]を作成するには、メインナビゲーションで *Monitors --> New Monitor --> Logs* の順に進みます。

### 検索クエリを定義する

検索クエリを定義すると、検索フィールドの上にあるグラフが更新されます。

1. [ログエクスプローラーでの検索][3]と同じロジックを使用して検索クエリを作成します。
2. ログカウント、[ファセット][4]、または[メジャー][4]のモニターを選択します。
    * **Monitor over a log count**: 検索バーを使用し（任意）、ファセットまたはメジャーを選択**しません**。選択されたタイムフレームで Datadog がログ数を評価し、それをしきい値の条件と比較します。
    * **Monitor over a facet**: [ファセット][4]を選択すると、モニターはファセットの `Unique value count` に対してアラートを発出します。
    * **Monitor over measure**: [メジャー][4]が選択されている場合、モニターは (メトリクスモニターと同様に) ログファセットの数値に対してアラートを発出します。また、集計を選択する必要があります（`min`、`avg`、 `sum`、`median`、`pc75`、`pc90`、`pc95`、`pc98`、`pc99`、または `max`）。
3. アラート設定のグループ化方法を構成します（任意）:
    * **Simple alert**: すべてのソースをまとめて集計します。集計値が設定条件を満たすと、1 件のアラートを受け取ります。これは、単一のホストから受け取るメトリクスまたは多くのホストからの合計メトリクスを監視する場合に最適です。通知件数を減らしたい場合にこの方法を選択します。
    * **Multi-Alert**: グループパラメーターに従い、複数のアラートを各ソースに適用します（最大 100 件の一致するグループ）。アラートイベントは、設定された条件を満たすと各グループに生成されます。たとえば、`system.disk.in_use` を `device` でグループ化すると、容量不足のデバイスに対してアラートを個別に送信できます。

### アラートの条件を設定する

* メトリクスが `above`、`above or equal to`、`below`、`below or equal to` の場合にトリガーされる
* 過去 `5 minutes`、`15 minutes`、`1 hour` などの間のしきい値、または `custom` に 5 分～48 時間の値を設定します。
* アラートのしきい値 `<数値>`
* 警告のしきい値 `<数値>`

#### データなしと下限のアラート

サービス内のすべてのグループがログの送信を停止した場合に通知を受け取るには、条件を `below 1` に設定します。これにより、すべての集計グループについて、指定のタイムフレームでモニタークエリと一致するログがない場合に通知が行われます。

モニターを何らかのディメンション (タグまたはファセット) で分割している場合に `below` 条件を使用すると、特定のグループのログが存在してカウントがしきい値未満である**場合に限り**、または**すべての**グループについてログが存在しない場合に、アラートがトリガーされます。

**例**:

* このモニターは、すべてのサービスについてログが存在しない場合にのみトリガーします。
  {{< img src="monitors/monitor_types/log/log_monitor_below_by_service.png" alt="サービスで分割された下限モニター"  style="width:60%;" >}}
* このモニターは、サービス `backend` のログが存在しない場合にトリガーします。
  {{< img src="monitors/monitor_types/log/log_monitor_below_condition.png" alt="バックエンドサービスの下限モニター"  style="width:60%;" >}}

### 通知

**Say what's happening** と **Notify your team** のセクションに関する詳しい説明は、[通知][5] のページを参照してください。

#### ログのサンプル

デフォルトでは、ログモニターをトリガーすると、サンプルまたは値が通知メッセージに追加されます。

| モニターの対象     | 通知メッセージに追加されるもの                                                                            |
|------------------|----------------------------------------------------------------------------------------------------------|
| ログ数        | グループ: 上位 10 個の違反値とそれぞれの数。<br>非グループ: 上位 10 個のログサンプル。 |
| ファセットまたはメジャー | 上位 10 個のファセットまたはメジャーの値。                                                                      |

これらの通知の送信に、Slack、Jira、webhooks、Microsoft Teams、Pagerduty、電子メールを使用することができます。**注**: サンプルはリカバリ通知には表示されません。

ログサンプルを無効にするには、**Say what's happening** セクションの一番下にあるチェックボックスをオフにします。チェックボックスの隣に表示されるテキストは、モニターのグループ化によって変わります（上記を参照）。

#### 例

上位 10 の違反値の表を含める:
{{< img src="monitors/monitor_types/log/top_10_breaching_values.png" alt="上位 10 の違反値"  style="width:60%;" >}}

10 のログのサンプルをアラート通知に含める:
{{< img src="monitors/monitor_types/log/10_sample_logs.png" alt="上位 10 の違反値"  style="width:60%;" >}}

## その他の参考資料

{{< partial name="whats-next/whats-next.html" >}}

[1]: /ja/logs/
[2]: https://app.datadoghq.com/monitors#create/log
[3]: /ja/logs/explorer/search/
[4]: /ja/logs/explorer/facets/
[5]: /ja/monitors/notifications/