---
title: イベントモニター
kind: documentation
description: Datadog によって収集されたイベントを監視する
further_reading:
  - link: /monitors/notifications/
    tag: Documentation
    text: モニター通知の設定
  - link: /monitors/downtimes/
    tag: Documentation
    text: モニターをミュートするダウンタイムのスケジュール
  - link: /monitors/monitor_status/
    tag: Documentation
    text: モニターステータスを確認
---
## 概要

イベントモニターを使用すると、検索クエリと一致するイベントが発生したときにアラートを生成できます。

## モニターの作成

Datadog で[イベントモニター][1]を作成するには、メインナビゲーションで *Monitors --> New Monitor --> Metric* の順に移動します。

{{< site-region region="us" >}}
### カウントするイベントを選択する

下記のパラメーターを入力すると、検索フィールドの上にあるイベント一覧にフィルターがかかります。

* `<TEXT>` を含むイベントと一致
* ステータスが `error`、`warning`、`info` または `success`
* 優先度が `all`、`normal` または `low`
* 報告元 `<ソース>`
* 対象 `<タグ>`
* 除外 `<タグ>`

アラートグループを選択します。

* **シンプルアラート**では、すべての報告元ソースを集計します。集計値が設定条件を満たすと、アラートを 1 件受信します。
* **マルチアラート**では、グループパラメーターに従って、ソースごとにアラートを適用します。設定条件を満たすと各グループにつき  1 件のアラートを受信します。
{{< /site-region >}}
{{< site-region region="eu" >}}

### カウントするイベントを選択する

下記のパラメーターを入力すると、検索フィールドの上にあるイベント一覧にフィルターがかかります。

* `<TEXT>` を含むイベントと一致
* ステータスが `error`、`warning`、`info` または `success`
* 優先度が `all`、`normal` または `low`
* 報告元 `<ソース>`
* 対象 `<タグ>`
* 除外 `<タグ>`

アラートグループを選択します。

* **シンプルアラート**では、すべての報告元ソースを集計します。集計値が設定条件を満たすと、アラートを 1 件受信します。
* **マルチアラート**では、グループパラメーターに従って、ソースごとにアラートを適用します。設定条件を満たすと各グループにつき  1 件のアラートを受信します。
{{< /site-region >}}
{{< site-region region="gov" >}}

### 検索クエリを定義する

検索クエリを定義すると、上部のグラフが更新されます。

1. [ログエクスプローラーでの検索][2]と同じロジックを使用して検索クエリを作成します。
2. イベント数、ファセット、またはメジャーのモニタリングを選択します。
    * **Monitor over an event count**: 検索バーを使用し（任意）、ファセットまたはメジャーを選択**しません**。選択されたタイムフレームで Datadog がイベント数を評価し、それをしきい値の条件と比較します。
    * **Monitor over a facet**: ファセットが選択されていると、モニターはファセットのユニークな値のカウントに対してアラートを作成します。
    * **Monitor over measure**: メジャーが選択されている場合、モニターは (メトリクスモニターと同様に) イベントファセットの数値に対してアラートを出します。また、集計を選択する必要があります（`min`、`avg`、 `sum`、`median`、`pc75`、`pc90`、`pc95`、`pc98`、`pc99`、または `max`）。
3. アラートのグループ化方法を構成します（任意）:
    * **Simple alert**: すべてのソースをまとめて集計します。集計値が設定条件を満たすと、1 件のアラートを受け取ります。これは、単一のホストから受け取るメトリクスまたは多くのホストからの合計メトリクスを監視する場合に最適です。通知件数を減らしたい場合にこの方法を選択します。
    * **Multi-Alert**: グループパラメーターに従い、複数のアラートを各ソースに適用します（最大 100 件の一致するグループ）。アラートイベントは、設定された条件を満たすと各グループに生成されます。たとえば、`system.disk.in_use` を `device` でグループ化すると、容量不足のデバイスに対してアラートを個別に送信できます。

[2]: /ja/logs/explorer

{{< /site-region >}}
{{< site-region region="us3" >}}

### 検索クエリを定義する

検索クエリを定義すると、上部のグラフが更新されます。

1. [ログエクスプローラーでの検索][3]と同じロジックを使用して検索クエリを作成します。
2. イベント数、ファセット、またはメジャーのモニタリングを選択します。
    * **Monitor over an event count**: 検索バーを使用し（任意）、ファセットまたはメジャーを選択**しません**。選択されたタイムフレームで Datadog がイベント数を評価し、それをしきい値の条件と比較します。
    * **Monitor over a facet**: ファセットが選択されていると、モニターはファセットのユニークな値のカウントに対してアラートを作成します。
    * **Monitor over measure**: メジャーが選択されている場合、モニターは (メトリクスモニターと同様に) イベントファセットの数値に対してアラートを出します。また、集計を選択する必要があります（`min`、`avg`、 `sum`、`median`、`pc75`、`pc90`、`pc95`、`pc98`、`pc99`、または `max`）。
3. アラートのグループ化方法を構成します（任意）:
    * **Simple alert**: すべてのソースをまとめて集計します。集計値が設定条件を満たすと、1 件のアラートを受け取ります。これは、単一のホストから受け取るメトリクスまたは多くのホストからの合計メトリクスを監視する場合に最適です。通知件数を減らしたい場合にこの方法を選択します。
    * **Multi-Alert**: グループパラメーターに従い、複数のアラートを各ソースに適用します（最大 100 件の一致するグループ）。アラートイベントは、設定された条件を満たすと各グループに生成されます。たとえば、`system.disk.in_use` を `device` でグループ化すると、容量不足のデバイスに対してアラートを個別に送信できます。

[3]: /ja/logs/explorer
{{< /site-region >}}


### アラートの条件を設定する

* カウントが `above`、`above or equal to`、`below`、または `below or equal to` の時
* `<しきい値の数>`
* 過去 `5 minutes`、`15 minutes`、`1 hour` など、または `custom` に 5 分～48 時間の値を設定します。

**注**: 一部のプロバイダーでは、イベントが**ポスト**されてから実際に開始されるまでにかなりの遅延が生じます。このような場合、Datadog は発生時刻にまでさかのぼってイベントを記録しますが、これにより現在のモニター評価ウィンドウ外のイベントを認識することがあります。評価ウィンドウを広げると時間差が発生する原因を理解しやすくなります。適切なモニター設定の調整についてサポートが必要な場合は、[Datadog のサポートチーム][3]までお問い合わせください。

### 通知

**Say what's happening** と **Notify your team** のセクションに関する詳しい説明は、[通知][4]のページを参照してください。

#### イベントテンプレート変数

イベントモニターには、通知メッセージを入力できる特殊なテンプレート変数があります。

| テンプレート変数          | 定義                                                                     |
|----------------------------|--------------------------------------------------------------------------------|
| `{{event.id}}`             | イベントの ID。                                                           |
| `{{event.title}}`          | イベントのタイトル。                                                        |
| `{{event.text}}`           | イベントのテキスト。                                                         |
| `{{event.host.name}}`      | イベントを生成したホストの名前。                                 |
| `{{event.tags}}`           | イベントに関連したタグのリスト                                          |
| `{{event.tags.<タグ_キー>}}` | イベントに関連した特定のタグキーの値。下記のサンプルを参照してください。 |

##### `key:value` 構文のタグ

次のタグ専用: `env:test`、`env:staging`、`env:prod`。

* `env` はタグキーです。
* `test`、`staging`、`prod` はタグ値です。

テンプレート変数は `{{event.tags.env}}` です。このテンプレート変数を使用した場合の結果は、`test`、`staging`、または `prod` です。

## その他の参考資料

{{< partial name="whats-next/whats-next.html" >}}

[1]: https://app.datadoghq.com/monitors#create/event
[2]: /ja/logs/explorer
[3]: /ja/help/
[4]: /ja/monitors/notifications/