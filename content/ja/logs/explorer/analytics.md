---
title: ログ分析
kind: documentation
description: ログ分析の実行
aliases:
  - /ja/logs/graph
  - /ja/logs/analytics
further_reading:
  - link: logs/processing
    tag: Documentation
    text: ログの処理方法について
  - link: logs/processing/parsing
    tag: Documentation
    text: パースの詳細
  - link: logs/explorer
    tag: Documentation
    text: ログの調査方法
  - link: logs/explorer/patterns
    tag: Documentation
    text: ログ内のパターン検出
---
## 概要

ログ分析は、ログ検索ページを拡張して、トラブルシューティングや監視のためのログの集約および分割機能を提供します。
分析ページにアクセスするには、いずれかのログエクスプローラービューで検索クエリバーの横にある "分析" アイコンをクリックします。

以下を制御することができます。

- 分析するログセットをフィルタリングするクエリ
- データの分割に使用するディメンション
- 集計や分割を可視化する方法

可視化された分析から、さらに以下を行うことができます。

- 可視化したデータのウィジェットをダッシュボードで作成
- クエリからモニターを作成
- 可視化によって可能になる操作に応じて、ログリストの各部を詳細に調べる

ログ分析は、"Save As" ボタンを使用して保存できます。また、"Saved Views" タブから、チームメンバーが保存したビューをロードできます。

## 分析クエリの構築

クエリを使用して、ログ分析に何を表示するかを制御できます。

1. グラフ化する[メジャー][1]または[ファセット][1]を選択します。[メジャー][1]を選ぶと、集計関数を選択できます。[ファセット][1]を選ぶと、ユニーク数が表示されます。

    {{< img src="logs/explorer/facet/measure_facet.png" alt="メジャーまたはファセットの選択"  style="width:50%;">}}

2. グラフ化する[メジャー][1]の集計関数を選択します。

3. [ファセット][1]を使用して、グラフを分割します。

4. 選択した[メジャー][1]に応じて、上位 (**top**) _X_ 個と下位 (**bottom**) _X_ 個のどちらの値を表示するかを選択します。

5. グラフのタイムステップ値を選択します。
   グローバルタイムフレームを変更すると、使用可能なタイムステップ値のリストも変更されます。

## 可視化方法

グラフセレクターを使用して、ログ分析の可視化タイプを選択します。

使用できる可視化タイプは以下のとおりです。

{{< tabs >}}
{{% tab "Timeseries" %}}

選択したタイムフレーム内の 1 つの[メジャー][1] (または[ファセット][1]の値のユニーク数) の動きを可視化し、(任意で) 使用可能な[ファセット][1]により分割します。

時系列では、次の表示オプションを追加できます。

- 表示するグラフの種類 (折れ線グラフ、棒グラフ、面グラフのいずれか)
- データ積み上げオプション（値またはパーセント値）
- カラーセット

データ積み上げに関する注意点

- データの積み上げは、分割を含むクエリリクエストにのみ使用できます。
- 積み上げオプションは、棒グラフと面グラフの表示にのみ使用できます。折れ線グラフは、常に重ねて表示されます。
- データの一部が表示されないトップリストオプションを使用している場合、積み上げデータは全体合計を表しません。これは、単に上位または下位の系列の小計を表します。
- 分割されたファセット内に一意でない値がある場合は、データを積み上げても意味がない場合があります。
- メジャーの集計方法によっては、データを積み上げても意味がない場合があります。

次の時系列ログ分析は、
**ユニーククライアント IP** の数に基づいて、過去 1 か月の**上位 5 の URL パス**の動きを示しています。

{{< img src="logs/explorer/timeseries.png" alt="時系列の例"  style="width:90%;">}}


[1]: /ja/logs/explorer/facets/
{{% /tab %}}

{{% tab "Top List" %}}

選択した[メジャー][1]に基づいて、[ファセット][1]の上位の値を可視化します。

次のトップリストログ分析は、
**ユニーククライアント IP** の数に基づいて、過去 1 か月の**上位 5 の URL パス**の動きを示しています。

{{< img src="logs/explorer/toplists.png" alt="トップリストの例"  style="width:90%;">}}


[1]: /ja/logs/explorer/facets/
{{% /tab %}}

{{% tab "Table" %}}

選択した[メジャー][1] (リストで選択した最初のメジャー) に基づいて[ファセット][1]の上位の値を可視化し、この上位の値に見られる要素に対して他のメジャーの値を表示します。検索クエリを更新したり、いずれかのディメンションに対応するログをドリルスルーすることができます。

- 複数のディメンションがある場合、上位の値は最初のディメンションに基づき決定されます。その後最初のディメンション内の上位値内の2番めのディメンション、次に2番目のディメンション内の上位値内の3番めのディメンションに基づき決定されます。
- メジャーが複数ある場合、最初のメジャーに応じて上位または下位リストが決定されます。
- <mrk mid="71" mtype="seg"/><mrk mid="72" mtype="seg"/>

    **注**: 単一のメジャーと単一のディメンジョンに使用されるテーブルの可視化では表示の仕方が異なりますが、内容は上位リストと同じです。

次のテーブルログ分析は、**スループット**に基づいて、過去 15 分間の**上位ステータスコード**の動きをユニーク**クライアント IP** の数と共に示しています。

[1]: /ja/logs/explorer/facets/
{{% /tab %}}
{{< /tabs >}}

## 関連ログ

グラフの一部を選択またはクリックすると、グラフをズームインしたり、選択範囲に対応するログのリストを表示したりすることができます。

## 共有ビュー

_共有_ 機能を使用して、現在のログ表示をエクスポートします。

- **モニター**へエクスポート: 新しい[ログモニター][2]用のクエリを作成するために、ログ分析に適用するクエリをエクスポートします。
- **ダッシュボード**へエクスポート: 既存または新しい[ダッシュボード][3]に現在の分析をウィジェットとしてエクスポートします。
- 新しい**メトリクス**を生成: 現在の分析クエリから[新しいメトリクスを生成][4]します。

## 集計機能の動作の詳細

Datadog は、対象のタイムフレームに含まれる一連のログを使用して、集計値 (平均、合計、パーセンタイルなど) を計算します。

以下では、それぞれが 1 つの時間間隔を表している架空のバータイムラインについて説明します。この例で、Datadog は、ログセット全体から時間間隔ごとに 1 つの集計値を作成します。ログイベントは、時間的に常に均一に分散しているわけではありません。そのため、常に同じ量のログから集計値が作成されるわけではありません。

次の例では、各ドットが 1 つのログイベントを表します。X 軸はログのタイムスタンプ、Y 軸はログが持つ duration 属性の値です。この時系列は、最大値集計を表示しています。タイムラインはロールアップパラメーターと共に表示されます。たとえば、ここではタイムフレーム全体に 4 つの棒が表示されています。

## その他の参考資料

{{< partial name="whats-next/whats-next.html" >}}

[1]: /ja/logs/explorer/facets/
[2]: /ja/monitors/monitor_types/log/
[3]: /ja/dashboards/
[4]: /ja/logs/logs_to_metrics/
