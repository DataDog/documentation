---
description: どのように始めればよいのか、また、最初の段階でどのような重要な決定をすればよいのか。
kind: documentation
private: true
title: 基礎固め
---

このパートでは、Datadog マネージドサービスプロバイダーとしての旅の最初の段階で行うべき重要な決定事項について説明します。

## マネージドサービスプロバイダーが考慮すべき主な事項

サービスプロバイダーとして Datadog を使い始める方法は、ビジネスモデルや運用モデルによって異なります。

- **ビジネスモデル**: クライアントが Datadog にアクセスできるようにするかどうかが、重要なポイントになります。クライアントに Datadog へのアクセスを提供する場合、複数組織のアカウントを設定し、クライアントデータを分離して非公開にします。
- **運用モデル**: もう 1 つの重要な考慮点は、クライアントベースが多くの同種のクライアントで構成されており、見た目が似ている多くの Datadog 組織のプログラム管理がより重要であるか、またはクライアントの数が少ないか、異種であるかということです。

以上を踏まえて、Datadog による MSP のセットアップの基礎が整ったことになります。

## 前提条件

サービスプロバイダーとして Datadog の導入に取り組む前に、DPN ポータルで  [Datadog テクニカルスペシャリストトレーニング][16]を修了しておくことをお勧めします。

トレーニングや認定資格の取得により、次の章で取り上げる多くのトピックに慣れ、すぐに始めることができるようになります。

## 組織の設定

サービスプロバイダーが行うべき重要な決定の 1 つは、「組織」と呼ばれるクライアントの Datadog アカウントをどのように設定するかということです。ユーザーは複数の組織に関連付けることができますが、監視されるリソースは 1 つの組織に結びつきます。最初から正しい組織構造を選択することで、自社とクライアントの価値を迅速に創出することができます。

### 単一組織または複数組織

Datadog は、1 つの親組織から複数の子組織を管理することが可能です。これは、クライアントが互いのデータにアクセスできないようにするために、MSP が使用する典型的なデプロイモデルです。複数組織の設定では、各クライアントのために 1 つの子組織が作成され、クライアントは自分の子組織にのみアクセスできます。詳しくは、[クライアントの組織のプロビジョニングオプション](#client-org-provisioning-options)を参照してください。

クライアントに Datadog へのアクセスを提供する予定がなく、クライアントデータを分離するための厳格な要件がない場合は、単一組織設定を使用します。

組織管理の詳細については、[複数組織アカウントの管理][1]のドキュメントを参照してください。

### 開発、テスト、本番で組織を分ける？

MSP パートナーからのよくある質問は、開発、テスト、本番環境のリソースを管理するために、Datadog の組織を別々に設定する必要があるかというものです。

Datadog では、開発、テスト、本番のリソースを分けることは推奨していません。推奨されるアプローチは、全てのリソースを同じ Datadog 組織で管理し、タグで環境を区切ることです。詳細については、[タグ付け戦略][20]を参照してください。

## クライアントの組織のプロビジョニングオプション

クライアントの Datadog 組織を管理している場合、組織のプロビジョニングプロセスを制御し、新規ユーザーのプロビジョニング、アクセス方法の設定、ロールベースのアクセス定義、クライアントの使用管理など、組織内の管理機能を実行したいと思うかもしれません。

そのためには、以下の作業を行います。

1. [親アカウントの下に子組織を作成する。](#create-a-child-organization-under-your-parent-account)
2. [新しい子組織の組織 ID を取得する。](#retrieve-the-new-client-orgs-org-id)
3. [新しい子組織を親アカウントから切り離す。](#separate-the-new-child-organization-from-your-parent-account)
4. [新しいクライアントの情報を DPN ポータルに登録する。](#register-the-new-client-details-in-the-dpn-portal)
5. [上のステップ 1 で作成した組織の下に子組織を作成する。](#create-a-new-child-organization-under-the-organization-created-in-step-1-above)

結果は以下のようになります。

- 新しい親組織が、新しいクライアントの 1 つまたは複数の子組織を管理する目的で作成されます。
- 新しい親組織とクライアントの子組織が登録され、請求契約に添付されます。
- 新規ユーザーのプロビジョニング、アクセス方法の構成、ロールベースのアクセス定義、新しいクライアント子組織の使用管理が可能になります。

### 親アカウントの下に子組織を作成する

このステップには 2 つのオプションがあります。

- UI を使用する: [複数組織アカウントの管理][1]で説明されているように、[New Organization]をクリックします。
- APIを使用する: [子組織を作成][18]するためのエンドポイントを使用します。

### 新しいクライアント組織の組織 ID を取得する

ブラウザの JavaScript コンソールを開き、次のように入力すれば、ログインしている Datadog 組織の ID を取得できますす。

```javascript
JSON.parse(document.querySelector('#_current_user_json').value).org.id
```

また、次の JavaScript 関数 を含む `Get Datadog OrgId` という名前のブックマークを作成することもできます。

```javascript
javascript:(function() {var orgId = JSON.parse(document.querySelector('#_current_user_json').value).org.id; alert("Datadog OrgId is " + orgId);})();
```

これで、Datadog のページにいるときにブックマークをクリックすると、ブラウザのアラートボックスに現在の組織 ID が表示されます。

### 新しい子組織を親アカウントから切り離す

このステップには 2 つのオプションがあります。
    - セルフサービス: [子組織のスピンオフ][19]のための API エンドポイントを使用して、新しい組織を単独の親組織にする。
    - サポートを依頼する: パートナーセールスマネージャーに連絡して、親アカウントから新組織を切り離してもらいます。

### 新しいクライアントの情報を DPN ポータルに登録する

- [DPN ポータル][16]にログインし、商談ダッシュボードの `+Register Deal` をクリックします。

- 新しいクライアントの情報 (組織 ID など) を入力して、新しいクライアント組織を登録します。

### 上のステップ 1 で作成した組織の下に新しい子組織を作成する

1. [上のステップ 1](#create-a-child-organization-under-your-parent-account) で作成した組織に切り替えます。
2. [上のステップ 1](#create-a-child-organization-under-your-parent-account) の指示に従って、クライアントの子組織を作成します。

## カスタムサブドメイン

多数の組織を扱う際に Datadog の使用感を向上させるには、カスタムサブドメイン機能を使用します。

デフォルトでは、どの Datadog 組織も Datadog のアクセスページ、[https://app.datadoghq.com][2] と [https://app.datadoghq.eu][3] からアクセスされるようになっています。ただし、カスタムサブドメインを使用することで、各サブ組織に一意の URL を付与することができます (例: `https://account-a.datadoghq.com`)。

詳しくは、[カスタムサブドメイン][4]をご覧ください。

## ユーザーロールとカスタムロールベースアクセスコントロール (RBAC)

経験上、MSP 内部のユーザーとクライアントのユーザーの両方は、しばしば 3 つの [Datadog のデフォルトロール][5]のいずれかに明確に分類されないことがあります。特定の分野でユーザー権限を制限するには、カスタムロールを作成するのが望ましいです。

詳しくは、こちらをご覧ください。

- [カスタムロール][6]
- [ロールベースアクセスコントロール][7]

## シングルサインオン (SSO) に関する考慮点

サービスプロバイダーのコンテキストでは、シングルサインオン (SSO) について 2 つの考慮事項があります。

- 組織のためのシングルサインオン
- クライアントのためのシングルサインオン

統一された認証メカニズムという明白な利点のほかに、SAML シングルサインオンを使用すると、ユーザのプロビジョニングプロセスが大幅に簡略化されます。SAML を使用すると、ジャストインタイム (JiT) ユーザープロビジョニングを使用できるため、手動またはプログラムによるユーザ作成が不要になります。

SAML 認証は、Datadog の組織またはサブ組織で有効になります。つまり、サブ組織ごとに異なる SAML プロバイダーを持つことができるのです。しかし、これは、異なる SAML プロバイダーを持つユーザーの 2 つのグループがある場合、それらのユーザーは別々の組織にいなければならないことも意味します。複数組織の設定を計画する際には、SAML 認証について考えておくようにしましょう。

詳しくは、こちらをご覧ください。

- 複数組織アカウントに [SAML を設定する][8]
- [SAML によるシングルサインオン][9]

## ユーザーの管理

### ユーザーの作成

Datadog は、各組織のユーザーを迅速にプロビジョニングするための複数の方法を提供しています。

- [UI によるユーザーの一括追加][10]
- [API によるユーザー作成][11]
- SAML のような認証サービスと[ジャストインタイム (JiT) プロビジョニング][12]を併用する

### ユーザートレーニング

Datadog の目標は、簡単で直感的に使えるサービスを提供することです。経験上、ほとんどのユーザーが快適に製品を操作し、学びながら進めています。

ここでは、製品の最も重要な点に関するトレーニングを希望するユーザーにとって有用なリソースを紹介します。

- [Datadog の YouTube チャンネル][13]: Datadog の YouTube チャンネルでは、新機能がリリースされるたびに紹介ビデオが投稿され、ヒントとコツやベストプラクティスに関するビデオもあり、ハイレベルなトレーニングに最適なソースとなっています。
- [Datadog ラーニングセンター][14]: Datadog ラーニングセンターは、ユーザーがプラットフォームを深く知るための素晴らしい方法です。ラーニングセンターに登録すると、Datadog のサンドボックス環境が自動的に無料でプロビジョニングされ、ユーザーは何かを壊す心配なく製品を使いこなすことができるようになります。
- [Datadog ブログ][15]: 700 以上のエントリーがあるこのブログは、クライアント環境における主要なサービス、ツール、テクノロジーを監視するための Datadog の使い方や、最新の製品リリースに関する情報を提供する重要な情報源となっています。
- [Datadog Partner Network (DPN) Enablement Center][16]: DPN を通じて、Datadog のパートナーは、サービスプロバイダーの営業担当者や技術専門家向けの一連のビデオコースにアクセスすることができます。

クライアント向けに独自のトレーニング教材を作成する予定がある場合や、どのようなコンテンツが有用かについて推奨がある場合は、Datadog パートナーの担当者にお問い合わせください。

## 次のステップ

次のパート、[データの取り込み][17]では、Datadog にデータを送り込むことに焦点を当てます。

[1]: /ja/account_management/multi_organization/
[2]: https://app.datadoghq.com
[3]: https://app.datadoghq.eu
[4]: /ja/account_management/multi_organization/#custom-sub-domains
[5]: /ja/account_management/rbac/?tab=datadogapplication#datadog-default-roles
[6]: /ja/account_management/rbac/?tab=datadogapplication#custom-roles
[7]: /ja/account_management/rbac/
[8]: /ja/account_management/multi_organization/#set-up-saml
[9]: /ja/account_management/saml/
[10]: /ja/account_management/users/#add-new-members-and-manage-invites
[11]: /ja/api/latest/users/#create-a-user
[12]: /ja/account_management/saml/#just-in-time-jit-provisioning
[13]: https://www.youtube.com/user/DatadogHQ
[14]: https://learn.datadoghq.com/
[15]: https://www.datadoghq.com/blog/
[16]: https://partners.datadoghq.com/
[17]: /ja/partners/data-intake/
[18]: /ja/api/latest/organizations/#create-a-child-organization
[19]: /ja/api/latest/organizations/#spin-off-child-organization
[20]: /ja/partners/data-intake/#tagging-strategy