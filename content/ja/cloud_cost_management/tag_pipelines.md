---
further_reading:
- link: /cloud_cost_management/
  tag: ドキュメント
  text: Cloud Cost Management
kind: ドキュメント
title: タグパイプライン
---

{{< site-region region="gov" >}}
<div class="alert alert-warning">Cloud Cost Management はこのサイトではサポートされていません。</div>
{{< /site-region >}}

## 概要

クラウドのコストを効果的に監視するには、さまざまなサービス、チーム、製品が全体的なコストにどのように寄与しているかを完全かつ詳細に把握する必要があります。タグパイプラインは、クラウドリソースが製品全体で活用できる標準タグを使用するようにし、リソースのコストデータが漏れないようにします。

[タグパイプライン][1]を使用してタグルールを作成し、クラウド請求書に記載されていないタグや不正確なタグを修正したり、ビジネスロジックに沿った新しい推論タグを作成したりすることができます。

## ルールタイプ

<div class="alert alert-warning"> 作成できるルールは最大 100 個で、API ベースのリファレンステーブルはサポートされていません。 </div>

3 種類のルールがサポートされています。**Add tag** (タグの追加)、**Alias tag keys** (タグキーのエイリアス設定)、**Map multiple tags** (複数のタグのマッピング) です。ルールセットを活用することで、ルールを整理することができます。ルールセットは、ルールのフォルダーとして機能します。ルールは、決定論的な順序で (上から下へ) 実行されます。ルールとルールセットを整理することで、実行順序をビジネスロジックと一致させることができます。

### タグの追加

クラウドコストデータに存在する既存のタグに基づいて、新しいタグ (キー + 値) を追加します。

例えば、リソースが所属するサービスに基づいて、すべてのリソースにビジネスユニットのタグを付けるルールを作成できます。

{{< img src="cloud_cost/tags_addnew.png" alt="service:processing、service:creditcard、または service:payment-notification を持つリソースに新しいビジネスユニットタグを追加します。" >}}

### タグキーのエイリアス設定

  既存のタグ値をより標準化されたタグにマッピングします。

例えば、組織で標準の `application` タグキーを使用したいが、いくつかのチームがそのタグのバリエーション（`app`、`webapp`、`apps` など）を持っている場合、`apps` を `application` にエイリアス設定することができます。各エイリアスタグルールでは、最大で 25 個のタグキーを新しいタグにエイリアス設定することができます。

ルールは最初のマッチが見つかった後、各リソースに対して実行を停止します。例えば、リソースがすでに `app` タグを持っている場合、ルールはもう `webapp` または `apps` タグを識別しようとしません。
{{< img src="cloud_cost/tags_alias.png" alt="app、webapp、apps タグを持つリソースにアプリケーションタグを追加します。" >}}

### 複数のタグのマッピング

[リファレンステーブル][2]を使用すると、複数のルールを作成することなく、コストデータに複数のタグを追加できます。これにより、リファレンステーブルのプライマリキー列の値がコストタグの値にマップされます。見つかった場合、パイプラインは選択したリファレンステーブルの列をタグとしてコストデータに追加します。

例えば、異なる AWS や Azure のアカウントがどの VP、組織、ビジネスユニットに属しているかの情報を追加したい場合、テーブルを作成してタグをマッピングします。タグキーのエイリアス設定と同様に、ルールは最初のマッチが見つかった後、各リソースに対して実行を停止します。例えば、`aws_member_account_id` が見つかった場合、ルールはもはや `subscriptionid` を見つけようとしません。
{{< img src="cloud_cost/tags_mapmultiple.png" alt="タグパイプラインのリファレンステーブルを使用して、VP、組織、ビジネスユニットなどのアカウントメタデータを追加します" >}}

## その他の参考資料

{{< partial name="whats-next/whats-next.html" >}}

[1]: https://app.datadoghq.com/cost/tag-pipelines
[2]: https://docs.datadoghq.com/ja/integrations/guide/reference-tables/?tab=manualupload