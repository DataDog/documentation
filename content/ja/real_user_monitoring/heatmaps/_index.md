---
description: ヒートマップは、ユーザーが Web サイト上でどこをクリックしたかを視覚化するものです。
further_reading:
- link: /real_user_monitoring/session_replay/
  tag: ドキュメント
  text: セッション リプレイ
kind: documentation
title: ヒートマップ
---

{{< img src="real_user_monitoring/heatmaps/heatmap.jpeg" alt="ヒートマップ機能の概要です。" style="width:100%;">}}

ヒートマップとは、ユーザーのセッションリプレイデータを視覚化したもので、ユーザーのインタラクション (クリック) が画像内の色で表現されています。ユーザーがどこをクリックしたかを見ることで、ユーザーが期待通りにページに関与しているか、アクションへの呼び出し (CTA) や重要なボタンがすべて見つかっているかを理解することができます。これらのインタラクションをヒートマップで視覚化することで、複雑なデータを一目で理解することが可能になります。ヒートマップから得られる知見を活用することで、ユーザー体験を最適化し、リテンションを高めるための UI の意思決定を行うことができます。

## 前提条件

ヒートマップを始めるには

- 最新バージョンの SDK (v4.20.0 以降) である必要があります
- [セッションリプレイ][1]を有効にします。
- SDK の初期化で `trackUserInteractions: true` を設定し、アクションの追跡を有効にします。
- ヒートマップがベータ版の間は、SDK の [package.json][2] ファイルに以下のコードを追加して、機能フラグを有効にしてください。

```json
datadogRum.init({
    ...
    trackUserInteractions: true,
    enableExperimentalFeatures: ['clickmap']
})
```

### はじめに

ビューリストページで、アプリケーションとビューを選択します。

{{< img src="real_user_monitoring/heatmaps/heatmap-view-list.png" alt="ヒートマップビューのリストからビューを選択する" style="width:100%;" >}}

これにより、特定のビューの[ヒートマップページ][3]が表示されます。上部の **View Name** と **Application** のセレクタで、表示するビューを切り替えることができます。ヒートマップは、すべてのユーザー (セッション) が 1 つのビューでクリックした場所の集計を表示します (ビューはアプリケーション内の 1 ページ)。各セッションは、1 人のユーザーのアクティビティであり、閲覧したすべてのページとクリックしたすべてのアクションを含む、そのユーザーが行ったすべてのことを含みます。

フィルターを調整する (特定の地域を見るなど) には、左側のパネルからフィルターを追加することができます。

{{< img src="real_user_monitoring/heatmaps/application-and-view.jpeg" alt="セッションリプレイを有効にしているアプリケーションとビューを選択するためのセレクタを表示します。" style="width:100%;">}}

## インサイト

右のパネルは、ヒートマップのデータを理解するのに役立ちます。

- 選択したアプリケーションのコンテキストにおける、選択したページの人気度。
- ページを閲覧したユニークユーザーの総数。
- フラストレーションシグナルが発生したページ上のアクション。

{{< img src="real_user_monitoring/heatmaps/insights-panel.png" alt="ヒートマップで検出された上位のインサイトを示すデータ。" style="width:60%;">}}

これらのクエリのいずれかをクリックすると、これらのデータポイントの分析ビューにピボットすることができます。

パネルの下には、そのページで発生したすべてのアクションが、頻度別にリストアップされています。アクションをクリックすると、そのインタラクションについてより詳しく理解することができます。例:

- ユーザーが行ったアクションの回数と、そのページでの上位アクションの全体的な分析での位置づけ。
- そのアクションにフラストレーションシグナルが発生していた場合 (例えば、ユーザーがそのボタンを激怒してクリックした場合) には、関連するフラストレーションシグナルも表示することができます。

{{< img src="real_user_monitoring/heatmaps/actions.jpeg" alt="アクションの例と、そのアクションについて得られる情報を表示します。" style="width:60%;">}}

### 次のステップ

分析結果を理解したら、次はヒートマップ以外の他のデータとの関連でアクションを理解することです。これは、[RUM エクスプローラー][4]にピボットしたり、[コンバージョン率を分析][5]するためにそのアクションを含むファネルを構築したりすることを意味するかもしれません。また、関連する[セッションリプレイ][1]を見て、セッション全体のコンテキストでユーザーがアクションを実行している様子を視覚化することもできます。

## トラブルシューティング

### あるビューのヒートマップを見ているのですが、予想外のページが表示されるのですが。

ヒートマップは、RUM のビュー名に基づいています。RUM アプリケーションの構成によっては、多くのページが同じビュー名の下にグループ化されたり、非常に特殊なビュー名を持つようになったりすることがあります。デフォルトのビュー名収集が十分でないと思われる場合は、[startView][6] 関数を使用して手動でオーバーライドすることができます。

### 選択したビューに、初期コンテンツが表示されないのですが。

ヒートマップは、セッションリプレイデータで生成されます。Datadog のインテリジェントなアルゴリズムは、最新のリプレイとページの初期状態に最もマッチするリプレイをスマートに選択します。場合によっては、正しいリプレイを見つけることができないこともあります。ヒートマップの背景を切り替えるには、**Choose Background** ボタンを使用して、ページの異なる状態を行き来し、探しているものを見つけることができます。

{{< img src="real_user_monitoring/heatmaps/heatmaps-background-selector.mp4" alt="背景選択ボタンで別の背景を選択する" video=true >}}

### ヒートマップ横のアクションリストに、ヒートマップでは見えない要素がアイコンで表示されているのですが。

{{< img src="real_user_monitoring/heatmaps/heatmaps-hidden-elements.png" alt="ヒートマップ上のアクションリストの非表示要素。" style="width:60%;">}}

アイコンのツールチップに **element is not visible** と表示されています。これは、その要素がページ上で一般的なアクションであるにもかかわらず、ヒートマップの背景には表示されていないことを意味します。その要素を見るには、右下の **Choose Background** をクリックして、ヒートマップの背景をその要素が存在するものに切り替えることができます。

### ヒートマップを作成しようとすると、"No Replay Data" (リプレイデータなし) という状態が表示されるのですが。

これは、Datadog が現在の検索フィルターに一致するヒートマップの背景として使用するセッションリプレイを見つけることができなかったことを意味します。[Browser SDK][2] でセッションの記録を開始したばかりの場合、セッションリプレイが表示できるようになるまでに数分かかることもあります。

### ヒートマップを作成しようとすると、"Not enough data to generate a heatmap" (ヒートマップを作成するためのデータが不足しています) という状態が表示されるのですが。

これは、Datadog が、現在選択されているリプレイと、いかなるユーザー アクションもマッチさせることができなかったことを意味します。これは、以下のような様々な理由で発生します。

- アプリケーションが最新の SDK バージョン (>= 4.20.0) を使用していない。
- RUM アクションが有効になっていない。[ユーザーインタラクションを追跡する][7]方法についてはこちらをご覧ください。
- 最近、お客様のページが大きく変わった。

### ページ内のユーザー情報がすべて空になっている。

ユーザー情報は、デフォルトでは収集されません。ヒートマップは、セッションデータで利用可能なユーザー情報を使用して、行動に関する関連する洞察を表示します。[データとコンテキストの変更][8]の手順に従って、RUM にユーザー情報を設定することができます。


[1]: /ja/real_user_monitoring/session_replay/
[2]: https://github.com/DataDog/browser-sdk/blob/main/packages/rum/package.json
[3]: https://app.datadoghq.com/rum/heatmap/view
[4]: /ja/real_user_monitoring/explorer/
[5]: /ja/real_user_monitoring/guide/alerting-with-conversion-rates/
[6]: /ja/real_user_monitoring/browser/modifying_data_and_context/?tab=npm#override-default-rum-view-names
[7]: /ja/real_user_monitoring/browser/tracking_user_actions/#manage-information-being-collected
[8]: /ja/real_user_monitoring/browser/modifying_data_and_context/?tab=npm#user-session