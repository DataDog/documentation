---
title: 収集された RUM iOS データ
kind: documentation
further_reading:
  - link: 'https://github.com/DataDog/dd-sdk-ios'
    tag: Github
    text: dd-sdk-ios ソースコード
  - link: /real_user_monitoring
    tag: ドキュメント
    text: Datadog Real User Monitoring
---
RUM SDK は、メトリクスと属性が関連付けられたイベントを生成します。メトリクスとは、イベント関連の計測に使用される定量化可能な値のことです。属性は、分析でメトリクスデータをスライス（グループ化）するために使用する定量化できない値です。

RUM SDK は、メトリクスと属性が関連付けられたイベントを生成します。すべての RUM イベントには、すべての[デフォルト属性](#default-attributes)があります。例: デバイスタイプ (`device.type`)、名前 (`usr.name`) や 国 (`geo.country`) などのユーザー情報。

追加の[特定のイベントタイプに固有のメトリクスと属性](#event-specific-metrics-and-attributes)があります。たとえば、メトリクス `view.time_spent` は "view" イベントに関連付けられ、属性 `resource.method` は "resource" イベントに関連付けられます。

このページでは、収集された各メトリクスと属性について説明します。

## デフォルト属性

RUM は、すべてのイベントに共通の属性および以下に挙げたイベントに特定の属性をデフォルトで収集します。また、[追加のイベント][1]でユーザーセッションデータを強化し、アプリケーションの監視やビジネス分析のニーズに合わせてイベントをデフォルトに設定することも可能です。


### 共通のコア属性

| 属性名   | タイプ    | 説明                                                                        |
|------------------|---------|------------------------------------------------------------------------------------|
| `date`           | 整数 | Epoch からのイベント開始時間 (ms)                                               |
| `type`           | 文字列  | イベントのタイプ (`view` や `resource` など)。                         |
| `service`        | 文字列  | ユーザーセッションを関連付けるために使用した、このアプリケーションの[統合サービス名][2]。 |
| `application.id` | 文字列  | Datadog アプリケーション ID。                                                        |

### デバイス

以下のデバイス関連属性は、Datadog により収集されるすべてのイベントに自動的にアタッチされます。

| 属性名                       | タイプ   | 説明                                                                                              |
|--------------------------------------|--------|----------------------------------------------------------------------------------------------------------|
| `device.type`                        | 文字列 | デバイスにより報告されたデバイスタイプ (System User-Agent)。                                            |
| `device.brand`                       | 文字列 | デバイスにより報告されたデバイスのブランド (System User-Agent)。                                           |
| `device.model`                       | 文字列 | デバイスにより報告されたデバイスモデル (System User-Agent)。                                           |
| `device.name`                        | 文字列 | デバイスにより報告されたデバイス名 (System User-Agent)。                                            |
| `connectivity.status`                | 文字列 | デバイスのネットワーク到達可能性の状態 (`connected`、`not connected`、`maybe`)。                           |
| `connectivity.interfaces`            | 文字列 | 利用可能なネットワークインターフェースのリスト (`bluetooth`、`cellular`、`ethernet`、`wifi` など)。 |
| `connectivity.cellular.technology`   | 文字列 | 携帯電話の接続に使用される無線技術のタイプ                                              |
| `connectivity.cellular.carrier_name` | 文字列 | SIM を取り扱う事業者名                                                                              |


### オペレーティングシステム

以下の OS 関連属性は、Datadog により収集されるすべてのイベントに自動的にアタッチされます。

| 属性名     | タイプ   | 説明                                                               |
|--------------------|--------|---------------------------------------------------------------------------|
| `os.name`          | 文字列 | デバイスにより報告される OS 名 (System User-Agent)          |
| `os.version`       | 文字列 | デバイスにより報告される OS バージョン (System User-Agent)       |
| `os.version_major` | 文字列 | デバイスにより報告される OS バージョンメジャー (System User-Agent) |


### 地理的位置

次の属性は、IP アドレスの地理的位置に関連しています。

| 完全名                           | タイプ   | 説明                                                                                                                               |
|------------------------------------|--------|-------------------------------------------------------------------------------------------------------------------------------------------|
| `geo.country`                      | 文字列 | 国の名前。                                                                                                                       |
| `geo.country_iso_code`             | 文字列 | 国の ISO コード (米国は `US`、フランスは `FR` など)。                                                  |
| `geo.country_subdivision`          | 文字列 | その国で最大規模の地方区分 (米国は `California` 州、フランスは `Sarthe` 県など)。 |
| `geo.country_subdivision_iso_code` | 文字列 | その国で最大規模の地方区分の ISO コード (米国は `CA`、フランスは `SA` など)。    |
| `geo.continent_code`               | 文字列 | 大陸の ISO コード (`EU`、`AS`、`NA`、`AF`、`AN`、`SA`、`OC`)。                                                                     |
| `geo.continent`                    | 文字列 | 大陸名 (`Europe`、`Australia`、`North America`、`Africa`、`Antartica`、`South America`、`Oceania`)。                        |
| `geo.city`                         | 文字列 | 都市名 (`Paris`、`New York` など)。                                                                                       |


### グローバルユーザー属性

[ユーザー情報の追跡][2]をグローバルに有効にして、ユーザー属性を収集しすべての RUM イベントに適用できます。

| 属性名 | タイプ   | 説明             |
|----------------|--------|-------------------------|
| `user.id`      | 文字列 | ユーザーの識別子。 |
| `usr.name`     | 文字列 | ユーザーの名前。       |
| `usr.email`    | 文字列 | ユーザーのメールアドレス。      |


## イベント固有のメトリクスと属性

Datadog リアルユーザーモニタリング SDK は、次の 6 種類のイベントを生成します。

| イベントタイプ | 保存期間 | 説明                         |
|------------|-----------|-------------------------------------|
| セッション    | 30 日   | セッションは、モバイルアプリケーションでの実際のユーザージャーニーを表します。セッションはユーザーがアプリケーションを起動したときに開始され、ユーザーがアクティブである限りライブのままになります。ユーザージャーニー中、セッションの一部として生成されたすべての RUM イベントは、同じ `session.id` 属性を共有します。 |
| ビュー       | 30 日   | ビューとは、モバイルアプリケーションの一意の画面（または画面の一部）のことです。個々の `UIViewControllers` は異なるビューとして分類されます。ユーザーがビューを維持している間、RUM イベント属性（エラー、リソース、アクション）が一意の `view.id` と共にビューにアタッチされます。                           |
| Resource   | 15 日   | リソースとは、モバイルアプリケーションのファーストパーティホスト、API、サードパーティプロバイダー、ライブラリへのネットワークリクエストのことです。ユーザーセッション中に生成されるすべてのリクエストは、一意の `resource.id` と共にビューにアタッチされます。                                                                       |
| エラー      | 30 日   | エラーとは、モバイルアプリケーションにより送信される例外で、それが生成されたビューにアタッチされます。                                                                                                                                                                                        |
| アクション     | 30 日   | アクションとは、モバイルアプリケーションでのユーザーアクティビティ（アプリケーションの起動、タップ、スワイプ、戻るなど）のことです。各アクションは、一意の `action.id` と共に、それが生成されたビューにアタッチされます。                                                                                                      |

次の図は、RUM イベント階層を示しています。

{{< img src="real_user_monitoring/data_collected/event-hierarchy.png" alt="RUM イベント階層" style="width:50%;border:none" >}}

### セッションメトリクス

| メトリクス                    | タイプ        | 説明                                         |
|---------------------------|-------------|-----------------------------------------------------|
| `session.time_spent`      | 数値（ns） | セッションに費やされた時間。                            |
| `session.view.count`      | 数値      | このセッションで収集されたすべてのビューの数。      |
| `session.error.count`     | 数値      | このセッションで収集されたすべてのエラーの数。     |
| `session.resource.count`  | 数値      | このセッションで収集されたすべてのリソースの数。  |
| `session.action.count`    | 数値      | このセッションで収集されたすべてのアクションの数。    |
| `session.long_task.count` | 数値      | このセッションで収集されたすべてのロングタスクの数。 |


### セッション属性

| 属性名               | タイプ   | 説明                                                                |
|------------------------------|--------|----------------------------------------------------------------------------|
| `session.id`                 | 文字列 | セッションのユニーク ID。                                                  |
| `session.type`               | 文字列 | セッションのタイプ (`user`)。                                              |
| `session.is_active`          | 文字列 | セッションが現在アクティブかどうかを示します                               |
| `session.initial_view.url`   | 文字列 | セッションの初期ビューの URL                                     |
| `ssession.initial_view.name` | 文字列 | セッションの初期ビューの名前                                    |
| `session.last_view.url`      | 文字列 | セッションの最後のビューの URL                                        |
| `session.last_view.name`     | 文字列 | セッションの最後のビューの名前                                       |
| `session.ip`                 | 文字列 | インテークの TCP 接続から抽出されたセッションの IP アドレス |
| `session.useragent`          | 文字列 | デバイスの情報を解釈するためのシステムユーザーエージェントの情報                            |


### ビューのメトリクス

RUM アクション、エラー、リソース、ロングタスクのイベントには、収集時のアクティブな RUM ビューイベントに関する情報が含まれています。

| メトリクス                | タイプ        | 説明                                                                  |
|-----------------------|-------------|------------------------------------------------------------------------------|
| `view.time_spent`     | 数値（ns） | このビューに費やされた時間。                                                 |
| `view.error.count`    | 数値      | このビューについて収集されたすべてのエラーの数。                                 |
| `view.resource.count` | 数値      | このビューについて収集されたすべてのリソースの数。                              |
| `view.action.count`   | 数値      | このビューについて収集されたすべてのアクションの数。                                |
| `view.is_active`      | boolean     | このイベントに対応するビューがアクティブであるとみなされるかどうかを示します。 |

### ビューの属性

| 属性名 | タイプ   | 説明                                                     |
|----------------|--------|-----------------------------------------------------------------|
| `view.id`      | 文字列 | event.view に対応する初期ビューのユニーク ID。  |
| `view.url`     | 文字列 | イベントに対応する `UIViewController` クラスの URL。 |
| `view.name`    | 文字列 | イベントに対応する、カスタマイズ可能なビューの名前。       |


### リソースのメトリクス

| メトリクス                         | タイプ           | 説明                                                                                     |
|--------------------------------|----------------|-------------------------------------------------------------------------------------------------|
| `duration`                     | 数値         | リソースのロードにかかった全時間。                                                         |
| `resource.size`                | 数値（バイト） | リソースのサイズ。                                                                                  |
| `resource.connect.duration`    | 数値（ns）    | サーバーへの接続が確立されるまでにかかった時間（connectEnd - connectStart）。                  |
| `resource.ssl.duration`        | 数値（ns）    | TLS ハンドシェイクに費やされた時間。                                                               |
| `resource.dns.duration`        | 数値（ns）    | 最後のリクエストの DNS 名が解決されるまでにかかった時間（domainLookupEnd - domainLookupStart）。     |
| `resource.redirect.duration`   | 数値（ns）    | 後続の HTTP リクエストにかかった時間（redirectEnd - redirectStart）。                            |
| `resource.first_byte.duration` | 数値（ns）    | 応答の最初のバイトを受信するまでにかかった時間（responseStart - requestStart） |
| `resource.download.duration`   | 数値（ns）    | 応答のダウンロードにかかった時間（responseEnd - responseStart）。                               |

### リソースの属性

| 属性                  | タイプ   | 説明                                                                              |
|----------------------------|--------|------------------------------------------------------------------------------------------|
| `resource.id`              | 文字列 | リソースの一意の識別子。                                                       |
| `resource.type`            | 文字列 | 収集されるリソースのタイプ (`xhr`、`image`、`font`、`css`、`js` など)。 |
| `resource.method`          | 文字列 | HTTP メソッド (`POST`、`GET` `PATCH`、`DELETE` など)。                       |
| `resource.status_code`     | 数値 | 応答ステータスコード。                                                                |
| `resource.url`             | 文字列 | リソースの URL。                                                                        |
| `resource.provider.name`   | 文字列 | リソースプロバイダー名。デフォルトは `unknown` となります。                                        |
| `resource.provider.domain` | 文字列 | リソースプロバイダーのドメイン。                                                            |
| `resource.provider.type`   | 文字列 | リソースプロバイダーのタイプ (`first-party`、`cdn`、`ad`、`analytics` など)。        |


### エラー属性

フロントエンドのエラーはリアルタイムモニタリング (RUM) で収集されます。エラーメッセージとスタックトレースが利用できる場合は含まれます。

| 属性        | タイプ   | 説明                                                                      |
|------------------|--------|----------------------------------------------------------------------------------|
| `error.source`   | 文字列 | エラーの発生元 (`webview`、`logger`、`network` など)。 |
| `error.type`     | 文字列 | エラーのタイプ (場合によってはエラーコード)。                                    |
| `error.message`  | 文字列 | イベントについて簡潔にわかりやすく説明する 1 行メッセージ。                |
| `error.stack`    | 文字列 | スタックトレースまたはエラーに関する補足情報。                    |
| `error.issue_id` | 文字列 | スタックトレースまたはエラーに関する補足情報。                    |

#### ネットワークエラー

ネットワークエラーには失敗した HTTP リクエストに関する情報が含まれます。次のファセットも収集されます。

| 属性                        | タイプ   | 説明                                                                       |
|----------------------------------|--------|-----------------------------------------------------------------------------------|
| `error.resource.status_code`     | 数値 | 応答ステータスコード。                                                         |
| `error.resource.method`          | 文字列 | HTTP メソッド (`POST`、`GET` など)。                                      |
| `error.resource.url`             | 文字列 | リソースの URL。                                                                 |
| `error.resource.provider.name`   | 文字列 | リソースプロバイダー名。デフォルトは `unknown` となります。                                 |
| `error.resource.provider.domain` | 文字列 | リソースプロバイダーのドメイン。                                                     |
| `error.resource.provider.type`   | 文字列 | リソースプロバイダーのタイプ (`first-party`、`cdn`、`ad`、`analytics` など)。 |


### アクションメトリクス

| メトリクス                  | タイプ        | 説明                                   |
|-------------------------|-------------|-----------------------------------------------|
| `action.loading_time`   | 数値（ns） | アクションのロード時間。               |
| `action.resource.count` | 数値      | このアクションにより発生したすべてのリソースの数。 |
| `action.error.count`    | 数値      | このアクションにより発生したすべてのエラーの数。    |

### アクションの属性

| 属性            | タイプ   | 説明                                                                     |
|----------------------|--------|---------------------------------------------------------------------------------|
| `action.id`          | 文字列 | ユーザーアクションの UUID。                                                        |
| `action.type`        | 文字列 | ユーザーアクションのタイプ (`tap`、`application_start`)。                           |
| `action.name`        | 文字列 | ユーザーアクションの名前。                                                        |
| `action.target.name` | 文字列 | ユーザーが操作したエレメント。自動収集されたアクションのみ対象 |



## その他の参考資料

{{< partial name="whats-next/whats-next.html" >}}

[1]: /ja/real_user_monitoring/ios/advanced_configuration/#enrich-user-sessions
[2]: /ja/real_user_monitoring/ios/advanced_configuration/#track-user-sessions