---
description: Datadog Agent をデータベースと統合する際のオーバーヘッドについて
title: DBM と Agent のインテグレーション時のオーバーヘッド
---

## 概要

Database Monitoring は、基本となる Datadog Agent 上で動作します。デフォルトでは、システムへの影響を最小限に抑えるために最適なパフォーマンス設定がされていますが、データ収集頻度やクエリサンプリングなどのパラメーターをワークロードに応じて調整する柔軟性があります。

このページには、Datadog Database Monitoring を有効にしたデータベースに対して実施したインテグレーションオーバーヘッドテストの結果が掲載されています。

## オーバーヘッドテストの結果

{{< tabs >}}
{{% tab "Postgres" %}}
Postgres インテグレーションのオーバーヘッドテストは、Amazon EC2 マシン `c5.xlarge` インスタンス (4 vCPU、8 GB RAM) で実行しました。テストに使用したデータベースは、Amazon RDS の `db.m5.large` インスタンス (2 vCPU、8 GB RAM) で動作する PostgreSQL 14.10 インスタンスです。このデータベースは、20 個のウェアハウスを持つ TPC-C ワークロードを実行していました。

| 設定                           | 収集間隔 |
| --------------------------------- | ------------------- |
| 最小収集間隔のチェック     | 15 秒                 |
| クエリメトリクスの収集間隔 | 10 秒                 |
| クエリサンプルの収集間隔 | 10 秒                 |
| 設定の収集間隔      | 600 秒                |
| スキーマの収集間隔        | 600 秒                |

* Agent テストのバージョン: `7.50.2`
* CPU: 平均で CPU の約 1% を使用
* メモリ: 約 300 MiB の RAM を使用 (RSS メモリ)
* ネットワーク帯域幅: 約 30 KB/秒 ▼ | 30 KB/秒 ▲
* Agent によるデータベースへのクエリオーバーヘッド: 約 1% の CPU 時間

**注**: ネットワーク帯域幅は、Agent から監視対象データベースおよびDatadog バックエンドへの送受信トラフィックの合計です。
{{% /tab %}}

{{% tab "MySQL" %}}
MySQL インテグレーションのオーバーヘッドテストは、Amazon EC2 マシン `c5.xlarge` インスタンス (4 vCPU、8 GB RAM) で実行しました。テストに使用したデータベースは、Amazon RDS の `db.m5.large` インスタンス (2 vCPU、8 GB RAM) で動作する MySQL 8.0 インスタンスです。このデータベースは、20 個のウェアハウスを持つ TPC-C ワークロードを実行していました。

| 設定                              | 収集間隔 |
| ------------------------------------ | ------------------- |
| 最小収集間隔のチェック        | 15 秒                 |
| クエリメトリクスの収集間隔    | 10 秒                 |
| クエリアクティビティの収集間隔 | 10 秒                 |
| クエリサンプルの収集間隔    | 1s                  |
| 設定の収集間隔         | 600 秒                |

* Agent テストのバージョン: `7.50.2`
* CPU: 平均で CPU の約 2% を使用
* メモリ: 約 300 MiB の RAM を使用 (RSS メモリ)
* ネットワーク帯域幅: 約 40 KB/秒 ▼ | 30 KB/秒 ▲
* Agent によるデータベースへのクエリオーバーヘッド: 約 1% の CPU 時間

**注**: ネットワーク帯域幅は、Agent から監視対象データベースおよびDatadog バックエンドへの送受信トラフィックの合計です。
{{% /tab %}}

{{% tab "SQL Server" %}}
SQL Server インテグレーションのオーバーヘッドテストは、Amazon EC2 マシン `c5.xlarge` インスタンス (4 vCPU、8 GB RAM) で実行しました。テストに使用したデータベースは、Amazon RDS の `db.m5.large` インスタンス (2 vCPU、8 GB RAM) で動作する SQL Server 2019 Standard Edition インスタンスです。このデータベースは、20 個のウェアハウスを持つ TPC-C ワークロードを実行していました。

| 設定                              | 収集間隔 |
| ------------------------------------ | ------------------- |
| 最小収集間隔のチェック        | 15 秒                 |
| クエリメトリクスの収集間隔    | 60s                 |
| クエリアクティビティの収集間隔 | 10 秒                 |
| 設定の収集間隔         | 600 秒                |

* Agent テストのバージョン: `7.50.2`
* CPU: 平均で CPU の約 1% を使用
* メモリ: 約 300 MiB の RAM を使用 (RSS メモリ)
* ネットワーク帯域幅: 約 40 KB/秒 ▼ | 30 KB/秒 ▲
* Agent によるデータベースへのクエリオーバーヘッド: 約 1% の CPU 時間

**注**: ネットワーク帯域幅は、Agent から監視対象データベースおよびDatadog バックエンドへの送受信トラフィックの合計です。
{{% /tab %}}

{{% tab "Oracle" %}}
Oracle インテグレーションのオーバーヘッドテストは、Amazon EC2 マシン `c5.xlarge` インスタンス (4 vCPU、8 GB RAM) で実行しました。テストに使用したデータベースは、Amazon RDS の `db.m5.large` インスタンス (2 vCPU、8 GB RAM) で動作する Oracle 19c インスタンスです。このデータベースは、20 個のウェアハウスを持つ TPC-C ワークロードを実行していました。

| 設定                              | 収集間隔 |
| ------------------------------------ | ------------------- |
| 最小収集間隔のチェック        | 10 秒                 |
| クエリメトリクスの収集間隔    | 60s                 |
| クエリアクティビティの収集間隔 | 10 秒                 |

* Agent テストのバージョン: `7.53.0`
* CPU: 平均で CPU の約 0.2% を使用
* メモリ: 約 270 MiB の RAM を使用 (RSS メモリ)
* ネットワーク帯域幅: ~6 KB/s ▼ | 4 KB/s ▲
* Agent によるデータベースへのクエリオーバーヘッド: 約 0.2% の CPU 時間

**注**: ネットワーク帯域幅は、Agent から監視対象データベースおよびDatadog バックエンドへの送受信トラフィックの合計です。
{{% /tab %}}
{{< /tabs >}}