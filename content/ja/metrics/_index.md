---
title: メトリクス
kind: documentation
disable_sidebar: true
aliases:
  - /ja/graphing/metrics/
  - /ja/metrics/introduction/
---
{{< whatsnext desc="このセクションには、次のトピックが含まれています。">}}
    {{< nextlink href="/metrics/explorer" >}}<u>メトリクスエクスプローラー</u> - すべてのメトリクスを探索し分析します。{{< /nextlink >}}
    {{< nextlink href="/developers/metrics/types" >}}<u>メトリクスタイプ</u> - Datadog に送信可能なメトリクスの種類。{{< /nextlink >}}
    {{< nextlink href="/metrics/advanced-filtering" >}}<u>高度なフィルタリング</u> - データをフィルタリングして、返されるメトリクスのスコープを絞り込みます。{{< /nextlink >}}
    {{< nextlink href="/metrics/summary" >}}<u>メトリクスの概要</u> - Datadog にレポートされるすべてのメトリクスをリストします。{{< /nextlink >}}
    {{< nextlink href="metrics/distributions/" >}}<u>ディストリビューションメトリクス</u> - データセット全体のグローバルパーセンタイルを計算します。{{< /nextlink >}}
{{< /whatsnext >}}

### メトリクスとは？

メトリクスは、レイテンシーからエラー率、ユーザーのサインアップまで、環境に関するあらゆる情報を経時的に追跡できる数値です。

### メトリクスが役立つ理由は？

メトリクスは、システムの全体像を提供します。それを使用して、環境の状態を一目で評価できます。たとえば、ユーザーが Web サイトをロードする速度や、サーバーの平均メモリ消費量などです。問題を特定したら、[ログ][1]と[トレース][2]を使用して、トラブルシューティングします。

システムの状態を追跡するメトリクスは、400 以上のサービスと Datadog のインテグレーションによって自動的に取得されます。ただし、ユーザーログインの数からユーザーカートのサイズ、チームのコードコミットの頻度まで、ビジネスに固有のメトリクス (カスタムメトリクスとも呼ばれます) を追跡することもできます。

さらに、メトリクスは、顧客からの需要を満たすために環境の規模を調整するのに役立ちます。リソースをどれだけ消費する必要があるかを正確に知ることは、お金を節約したり、パフォーマンスを向上させたりするのに役立ちます。

### Datadog でのメトリクス視覚化

[メトリクスエクスプローラー][3]、[ダッシュボード][4]、または[ノートブック][5]の Datadog アプリ全体でメトリクスを視覚化してグラフを作成できます。

以下は、時系列を視覚化した場合の例です。

{{< img src="metrics/introduction/timeseries_example.png" alt="時系列の例" >}}

この折れ線グラフは、x 軸の時間に対して、y 軸のユーザーが経験したレイテンシー (ミリ秒単位) をプロットします。

Datadog には、視覚化のための多くのタイプのグラフやウィジェットがあります。詳しくは、Datadog の[メトリクスグラフに関するブログシリーズ][6]をご覧ください。

### Datadog へのメトリクスの送信

メトリクスは、いくつかの場所から Datadog に送信できます。

- [Datadog がサポートするインテグレーション][7]: {{< translate key="integration_count" >}} 以上ある Datadog のインテグレーションには、すぐに使用できるメトリクスが含まれています。このメトリクスにアクセスするには、サービスの特定のページに移動し、インストール手順に従います。たとえば、EC2 インスタンスを監視する必要がある場合は、[Amazon EC2 インテグレーションドキュメント][8]に移動します。

- Datadog のプラットフォーム内で、メトリクスを直接生成できます。たとえば、ログに表示されるエラーステータスコードをカウントし、Datadog に[それを新しいメトリクスとして保存][9]することができます。

- 多くの場合、ビジネスに関連するメトリクス (ユーザーのログインや登録数など) を追跡する必要があります。このような場合、[カスタムメトリクス][10]を作成できます。カスタムメトリクスは、[Agent][11]、[DogStatsD][12]、または [HTTP API][13] を介して送信できます。

- さらに、[Datadog Agent][14] は、いくつかの標準メトリクス (CPU やディスク使用量など) を自動的に送信します。

すべてのメトリクス送信ソースとメソッドの概要については、[メトリクスタイプのドキュメント][15]を参照してください。

## メトリクスのクエリ

ダッシュボード、ノートブック、モニターのいずれを使用しても、グラフの作成方法は一定です。グラフエディタ UI を使用するか、生のクエリ文字列を直接変更するからのいずれかの方法により、グラフを作成できます。クエリ文字列を編集するには、右端の `</>` ボタンを押します。

### メトリクスクエリの構造

Datadog のメトリクスクエリは次のようになります。

{{< img src="metrics/introduction/color-query2.png" alt="カラーコードのセクションで示されたサンプルクエリ"  style="width:70%;">}}

このクエリはいくつかのステップに分けることができます。

#### メトリクス名

まず、グラフを作成する特定のメトリクスを検索または **Metric** の横にあるドロップダウンから選択します。使用するメトリクスが不明な場合は、メトリクスエクスプローラーまたはノートブックで開始します。メトリクスの概要ページで、アクティブにレポートを送信しているメトリクスのリストを確認することも可能です。

#### メトリクスのフィルタリング

メトリクスを選択したら、タグに基づいてクエリにフィルターを適用することができます。たとえば、`account:prod` を使用してクエリの_スコープ_を定義し、本番環境のホストからのメトリクスのみに絞り込むことができます。詳細は[タグ付けに関するドキュメント][16]を参照してください。

#### 時間の構成

次に、時間ロールアップを使用してデータの粒度を選択します。この例では、6 分 (360 秒) ごとに 1 つのデータポイントがあると定義しました。各タイムバケットのデータをどのように集計するかを選択することもできます。デフォルトでは、_平均_ が適用されますが、他の使用可能なオプションは _合計_、_最小_、_最大_、_カウント_ です。最大を適用する場合は、`.rollup(max, 60)` を使用します。

#### 空間の構成

Datadog では、「空間」とは、メトリクスがさまざまなホストやタグに分散される方法を指します。制御できる空間には、グループ化と集計という 2 つの異なる側面があります。

_グループ化_は、グラフ上の線を構成するものを定義します。たとえば、4 つのリージョンに数百のホストが分散している場合、リージョンごとにグループ化すると、リージョンごとに 1 つの線をグラフ化して、時系列の数を 4 つに減らすことができます。

_集計_は、各グループのメトリクスを組み合わせる方法を定義します。利用可能な集計には、合計、最小、最大、平均の 4 つがあります。

#### 関数の適用 (任意)

グラフ値は数学[関数][17]で変更することができます。これにより、整数とメトリクス (メトリクスを2乗するなど) 間、または 2 つのメトリクス間 (`jvm.heap_memory / jvm.heap_memory_max` のように、メモリ使用率に関する新しい時系列を作成するなど) の算術演算を実行することができます。

### 時間と空間の集計

_時間集計_と_空間集計_は、クエリの 2 つの重要なコンポーネントです。これらの集計がどのように機能するかを理解すると、グラフの誤解を避けるのに役立つため、これらの概念について以下で詳しく説明します。

#### 時間集計

Datadog は大量のポイントを保管しており、ほとんどの場合、そのすべてをグラフ上に表示することはできません。ピクセルよりもデータポイント数の方が多くなるためです。Datadog は時間集計を使用して、データポイントとタイムバケツを組み合わせることでこの問題を解決しています。これは_ロールアップ_と呼ばれます。クエリに定義した時間間隔が長くなると、データの粒度が粗くなります。

各タイムバケットのデータを組み合わせるために適用できる集計には、合計、最小、最大、平均、カウントの 5 つがあります。

クエリを実行するたびに時間集計が_常に_適用されることを覚えておくことが重要です。

#### 空間集計

空間集計は、ホスト、コンテナ、リージョンなどのタグによって単一のメトリクスを複数の時系列に分割します。たとえば、リージョンごとの EC2 インスタンスのレイテンシーを表示する場合は、空間集計を使用して各リージョンのホストを組み合わせる必要があります。

空間集計を使用するときに適用できる集計には、_合計_、_最小_、_最大_、_平均_の 4 つがあります。上記の例を使用して、ホストが us-east-1、us-east-2、us-west-1、us-west-2 の 4 つのリージョンに分散しているとします。各リージョンのホストは、集計関数を使用して組み合わせる必要があります。_最大_アグリゲーターを使用すると、各リージョンのホスト間で最大のレイテンシーが発生し、_平均_アグリゲーターを使用すると、リージョンごとの平均レイテンシーが発生します。

## メトリクスタイプとリアルタイムメトリクスの可視性

### メトリクスタイプ

Datadog では、カウント、ゲージ、レート、ヒストグラム、分布など、異なるユースケースに対応するいくつかの異なるメトリクスタイプをサポートしています。メトリクスタイプは、アプリのメトリクスで使用できるグラフと関数を決定します。

Datadog Agent が、送信するデータポイントごとに Datadog のサーバーに個別のリクエストを行うことはありません。代わりに、_フラッシュ時間間隔_で収集された値を報告します。メトリクスのタイプは、この間隔でホストから収集された値が送信のためにどのように集計されるかを決定します。

**_カウント_**タイプは、送信されたすべての値を時間間隔で合計します。これは、たとえば、Web サイトのヒット数を追跡するメトリクスに適しています。

1 秒あたりのヒット数に関心がある場合は、**_レート_**タイプがカウントを取得し、それを時間間隔の長さで除算します。

**_ゲージ_**タイプは、間隔中に報告された最後の値を取ります。このタイプは、RAM または CPU の使用量を追跡するのに役立ちます。最後の値を取得すると、時間間隔中のホストの動作の代表的な像が得られます。この場合、_カウント_などの別のタイプを使用すると、不正確で極端な値になる可能性があります。これは、正しいメトリクスタイプを選択することの重要性を表しています。

**_ヒストグラム_**は、送信された値を要約した 5 つの異なる値、平均、カウント、中央値、95 パーセンタイル、最大を報告します。これにより、5 つの異なる時系列が生成されます。このメトリクスタイプは、平均値を知るだけでは不十分なレイテンシーなどに適しています。ヒストグラムを使用すると、すべてのデータポイントを記録しなくても、データがどのように分散しているかを理解できます。

**_分布_**はヒストグラムに似ていますが、環境内のすべてのホストにわたって時間間隔中に送信された値を要約します。複数のパーセンタイルをレポートすることもできます(p50、p75、p90、p95、p99)。この強力な機能の詳細については、[ディストリビューションのドキュメント][18]をご覧ください。

各メトリクスタイプの詳細な例と送信手順については、[メトリクスタイプ][15]のドキュメントを参照してください。

### メトリクスに関するリアルタイム情報を表示する

[メトリクスの概要ページ][19]には、過去 1 時間、1 日、または 1 週間の指定されたタイムフレームで Datadog に報告されたメトリクスのリストが表示されます。メトリクスは、メトリクス名またはタグでフィルタリングできます。

メトリクス名をクリックすると、詳細サイドパネルに詳細情報が表示されます。詳細再度パネルには、メタデータ (タイプ、ユニット、間隔)、個別のメトリクスの数、レポートホストの数、送信されたタグの数、メトリクスで送信されたすべてのタグを含むテーブルなど、特定のメトリクスの重要な情報が表示されます。メトリクスで送信されているタグを確認すると、タグ値の組み合わせによって異なるため、メトリクスからレポートされる個別のメトリクスの数を理解するのに役立ちます。

注: メトリクスの概要の詳細サイドパネルで報告される個別のメトリクスの数によって請求が定義されるわけではありません。過去 1 か月間の使用量の正確な計算については、[使用量の詳細][20]を参照してください。

詳細については、[完全なメトリクスの概要ドキュメント][21]を参照してください。

## その他の参考資料

{{< whatsnext desc="メトリクスに関するトピックを続行する場合は、以下を確認してください。">}}
    {{< nextlink href="/metrics/advanced-filtering" >}}<u>高度なフィルタリング</u> - フィルターを使用して返されたメトリクスのスコープを絞り込みます。{{< /nextlink >}}
    {{< nextlink href="/metrics/distributions" >}}<u>ディストリビューションメトリクス</u> - データセット全体のグローバルパーセンタイルを計算します。{{< /nextlink >}}
{{< /whatsnext >}}

[1]: /ja/logs
[2]: /ja/tracing/
[3]: /ja/metrics/explorer/
[4]: /ja/dashboards/
[5]: /ja/notebooks/
[6]: https://www.datadoghq.com/blog/timeseries-metric-graphs-101/
[7]: /ja/integrations/
[8]: /ja/integrations/amazon_ec2/
[9]: /ja/logs/logs_to_metrics/
[10]: /ja/developers/metrics/
[11]: /ja/agent/
[12]: /ja/developers/metrics/dogstatsd_metrics_submission/
[13]: /ja/api/
[14]: https://docs.datadoghq.com/ja/agent/basic_agent_usage/
[15]: /ja/developers/metrics/types/
[16]: /ja/getting_started/tagging/using_tags/
[17]: /ja/dashboards/functions/
[18]: /ja/metrics/distributions/
[19]: https://app.datadoghq.com/metric/summary
[20]: /ja/account_management/billing/usage_details/
[21]: /ja/metrics/summary/