---
title: Continuous Profiler の請求
kind: ドキュメント
---
[Datadog Continuous Profiler][1] を使用すると、最小限のオーバーヘッドでスタック全体にわたって本番環境でのコードパフォーマンスを分析できます。コードプロファイリングを利用して、アプリケーションで最もリソースを消費するメソッドまたはクラスをすばやく検出および最適化できます。これにより、コードの効率が向上し、クラウドプロバイダーのコストが削減されます。

| 請求パラメーター  | 料金                                      | コンテナ                                                                 | 課金                                                                                                                                                                                                                                                                                                                          |
|--------------------|--------------------------------------------|-------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [プロファイラーホスト][2]      | [プロファイルされたホスト][2]あたり 12 ドル / 月 | プロファイルされたホストごとに 4 つのプロファイルされたコンテナ*が価格に含まれています。追加のプロファイルされたコンテナは、コンテナあたり月額 2 ドルで請求されます。    | Datadog は、Datadog Continuous Profiler サービスで同時に監視している一意の Continuous Profiler ホストの数を 1 時間に 1 回記録します。この 1 時間ごとの測定値は、月末に最高から最低の順に並べられ、Datadog は 9 番目に高い測定値 (2 月のみ 8 番目に高い値) に基づいて課金します。<br>さらに、Datadog は、プロファイルされているコンテナの総数を測定します。5 分ごとに 1 回、Datadog は、Datadog Continuous Profiler サービスで監視している一意のコンテナの数を記録します。Datadog は、監視対象のコンテナの端数時間に基づいて毎月課金します。Continuous Profiler では、Datadog は、Continuous Profiler サービスを実行しているコンテナのみをカウントして、監視対象のコンテナーの総数を求めます。 |


**注:** 1 つのプロファイルされたコンテナは、Continuous Profiler サービスを実行しているコンテナです。これには、プロファイルされていないコンテナは含まれません。たとえば、プロファイルされていないアプリケーションコンテナと同時に実行されている、プロファイルされていない DNS サービスコンテナは、4 つのプロファイラーコンテナの割り当てにカウントされません。

## デプロイのサンプルシナリオ

これらのサンプルケースは、年間請求レートを使用した一般的なユースケースを示しています。お客様のアカウントのボリュームディスカウントについては、営業担当者または[カスタマーサクセスマネージャー][3]までお問い合わせください。

### ケース 1: コンテナのないホスト

各ホストでプロファイルされている 1 つのアプリケーションを実行している 5 つのホストを使用しています。コンテナはありません。

| 対象ユニット  | 数量   | 料金                                                                                           | 計算式       | 小計              |
|----------------|------------|-------------------------------------------------------------------------------------------------|---------------|-----------------------|
| APM ホスト      | 5          | 12 ドル / ホスト                                                                                    | 5 * 12 ドル       | 60 ドル                   |
| プロファイルされたコンテナ  | 0 / ホスト | 追加のコンテナがないため 0 ドル                                                              | 0 * 2 ドル        | 0 ドル                    |
| 合計          |            |                                                                                                 | 60 ドル + 0 ドル      | **月額 60 ドル**    |


### ケース 2: 4 つのプロファイルされたコンテナを持つホスト

それぞれ 4 つのプロファイルされたコンテナを持つ 5 つのホストを使用しています。プロファイルされたコンテナは、コンテナから Datadog Agent にプロファイリングデータを送信することにより、Continuous Profiler サービスを実行しているコンテナです。これには、プロファイルされていないコンテナは含まれません。

| 対象ユニット  | 数量   | 料金                                                                                           | 計算式       | 小計              |
|----------------|------------|-------------------------------------------------------------------------------------------------|---------------|-----------------------|
| APM ホスト      | 5          | 12 ドル / ホスト                                                                                    | 5 * 12 ドル       | 60 ドル                   |
| プロファイルされたコンテナ  | 4 / ホスト | 4 つのコンテナがちょうど割り当て上限に達しているため 0 ドル。追加料金は発生しません        | 0 * 2 ドル        | 0 ドル                    |
| 合計          |            |                                                                                                 | 60 ドル + 0 ドル      | **月額 60 ドル**    |


### ケース 3: 6 つのプロファイルされたコンテナを持つホスト

ホストごとに 6 つのプロファイルされたコンテナを持つ 5 つのホストを使用しています。プロファイルされたコンテナは、コンテナから Datadog Agent にプロファイリングデータを送信することにより、Continuous Profiler サービスを実行しているコンテナです。これには、プロファイルされていないコンテナは含まれません。

| 対象ユニット  | 数量   | 料金                                                                                           | 計算式       | 小計              |
|----------------|------------|-------------------------------------------------------------------------------------------------|---------------|-----------------------|
| APM ホスト      | 5          | 12 ドル / ホスト                                                                                    | 5 * 12 ドル       | 60 ドル                   |
| プロファイルされたコンテナ  | 6 / ホスト | ホストあたりの追加コンテナあたり 2 ドル。この場合、各ホストに 6 - 4 = 2 の追加コンテナがあります        | 2  * 2 ドル * 5 ホスト         | 20 ドル                   |
| 合計          |            |                                                                                                 | 60 ドル + 20 ドル      | **月額 80 ドル**    |


### ケース 4: 5 つのコンテナを持つホスト、ただしプロファイルされるのは 2 つだけ

ホストごとに 5 つのコンテナを持つ 4 つのホストを使用していますが、プロファイルされたコンテナはそのうちの 2 つだけです。プロファイルされたコンテナは、コンテナから Datadog Agent にプロファイリングデータを送信することにより、Continuous Profiler サービスを実行しているコンテナです。これには、プロファイルされていないコンテナは含まれません。

| 対象ユニット  | 数量   | 料金                                                                                           | 計算式       | 小計              |
|----------------|------------|-------------------------------------------------------------------------------------------------|---------------|-----------------------|
| APM ホスト      | 5          | 12 ドル / ホスト                                                                                    | 5 * 12 ドル       | 60 ドル                   |
| プロファイルされたコンテナ  | 2 / ホスト | 2 つのコンテナが割り当て上限を下回っているため 0 ドル。追加料金は発生しません。プロファイルデータを報告しない残りの 3 つのコンテナは、割り当てにカウントされません。         | 0 * 2 ドル        | 0 ドル                    |
| 合計          |            |                                                                                                 | 60 ドル + 0 ドル      | **月額 60 ドル**    |


### ケース 5: プロファイルされたコンテナの数が異なるホスト

2 つのプロファイルされたホスト (ホスト A とホスト B) を使用しています。

* ホスト A は 8 つのコンテナを実行しています
* ホスト B は 2 つのコンテナを実行しています

10 個のコンテナすべてが、プロファイルされているアプリケーションインスタンスを実行しています。つまり、ホスト A には価格を超える 4 つの追加コンテナがあり、ホスト B はあと 2 つのコンテナを追加できます。

このシナリオでは、すべてのホストのすべてのコンテナを集計します (つまり 2 つのホスト、10 個のコンテナ)。次に、8 つのコンテナが料金に含まれ、2 つのコンテナが追加になります。したがって、内訳は次のようになります。


| 対象ユニット  | 数量   | 料金                                                                                           | 計算式       | 小計              |
|----------------|------------|-------------------------------------------------------------------------------------------------|---------------|-----------------------|
| APM ホスト      | 5          | 12 ドル / ホスト                                                                                    | 2 * 12 ドル       | 24 ドル                   |
| プロファイルされたコンテナ  | ホスト A + ホスト B の合計で 10 | 追加コンテナあたり 2 ドル。この場合、2 つのホストで最大 8 つのコンテナが許可されますが、2 つのホストで合計 2 つのコンテナがあります。10-8 = 2 の追加コンテナ        | 2 ドル * 2 ホスト        | 4 ドル                    |
| 合計          |            |                                                                                                 | 24 ドル + 4 ドル      | **月額 28 ドル**    |


## よくあるご質問
**1. Continuous Profiler の請求対象となるホストとは？**

ホストとは、1 つの物理的または仮想のオペレーティングシステムインスタンスです。Datadog では、お客様が Datadog インフラストラクチャーサービスで同時に監視しているホスト数を 1 時間に一度記録します。Continuous Profiler の請求では、プロファイラーライブラリがインストールされ、プロファイルを送信しているホストの数が 1 時間ごとに計算されます。この 1 時間ごとの測定値は、月末に最高から最低の順に並べられ、Datadog は 9 番目に高い測定値 (2 月のみ 8 番目に高い値) に基づいて課金します。

**2. コンテナごとに 1 つの Agent をデプロイする場合、料金はどのように計算されますか**

コンテナをデプロイする場合は、基底のホストにつき 1 つの Agent を設定することをお勧めします。1 つのコンテナごとに 1 つの Agent を稼働させると、各コンテナが 1 つのホストとして扱われるため、プロファイラーホストあたりの料金にコンテナの数をかけた金額が請求されます。

**3. 使用量が急激に増加した場合、料金はどうなりますか**

上位 99 パーセンタイルホストの毎時の測定値は月末に最高から最低の順に並べられ、Datadog は 9 番目に高い測定値 (2 月のみ 8 番目に高い値) に基づいて課金するため、予期しない高額請求が防がれるようになっています。

**4. Kubernetes の pause コンテナに対して課金されますか**

Kubernetes は、ポッドの IP アドレスを取得し、そのポッドに加わる他のコンテナに使用されるネットワークネームスペースを設定するために、pause コンテナを作成します。すべての pause コンテナはクオータから除外され、pause コンテナに対する課金はありません (Agent 5.8 以降が必要)。

**5. 利用するサービスの数とホスト数は、請求にどのように影響しますか**

Continuous Profiler は、サービスではなくプロファイルを送信する Agent でデプロイされたホストに基づいて請求されます。

**6. APM なしで Continuous Profiling を使用することはできますか？**

できません。APM を有効にせずに Continuous Profiling を使用したい場合は、[営業担当者][4]または[カスタマーサクセスマネージャー][3]までお問い合わせください。

[1]: /ja/tracing/profiling/
[2]: /ja/account_management/billing/pricing/#continuous-profiler
[3]: mailto:success@datadoghq.com
[4]: mailto:sales@datadoghq.com