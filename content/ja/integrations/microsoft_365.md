---
"categories":
- log collection
- security
"custom_kind": "インテグレーション"
"dependencies": []
"description": "Connect to Microsoft 365 to pull an organization's audit logs into Datadog's logging platform."
"doc_link": "https://docs.datadoghq.com/integrations/microsoft_365/"
"draft": false
"further_reading":
- "link": "https://www.datadoghq.com/blog/microsoft-365-integration/"
  "tag": Blog
  "text": Collect and monitor Microsoft 365 audit logs with Datadog
"git_integration_title": "microsoft_365"
"has_logo": true
"integration_id": ""
"integration_title": "Microsoft 365 Security and Audit Logs"
"integration_version": ""
"is_public": true
"manifest_version": "1.0"
"name": "microsoft_365"
"public_title": "Datadog-Microsoft 365 Security and Audit Logs"
"short_description": "View Microsoft 365 audit logs in Datadog from services such as: Microsoft Teams, Power BI, Azure Active Directory, Dynamics 365, and more"
"team": "web-integrations"
"version": "1.0"
---

<!--  SOURCED FROM https://github.com/DataDog/dogweb -->
## Overview

Integrate with Microsoft 365 to:

- View and parse your audit logs using Datadog's logging product
- Set monitors on events from your Microsoft 365 platform
- Leverage the Datadog suite of security tools to set security rules

## セットアップ

### インストール

Use the [Datadog Microsoft 365 tile][1] to install the integration.

Click **Install a New Tenant**. This directs you to login to your Microsoft 365 account for authorization. You must login with an admin account.

Optionally add comma separated custom tags that get attached to every log for this newly setup tenant, for example, `environment:prod,team:us`. These tags can be used to filter/analyze logs.

**Note**: Your organization must have [audit logging enabled][2] to use Datadog audit logging.

## 収集データ

### Logs

You can collect audit logs for all services mentioned in [Office 365 Management API schemas][3], such as:

- Microsoft Teams
- Power BI
- Azure Active Directory
- Dynamics 365
- Exchange
- SharePoint

The Microsoft 365 integration produces one log event per audit log. Collected logs are tagged with the source `microsoft-365`. Click below for a list of common log sources with summaries and links to preset log queries in Datadog.

<details>
  <summary><strong>Click to view common log sources</strong></summary>

[`AirInvestigation`][4]
: Related to Advanced eDiscovery and Advanced Threat Protection (ATP) investigations within Microsoft 365. These logs contain information about security incidents, investigations, and actions taken to mitigate threats, such as alerts, remediation steps, and forensic data.

[`Audit.AzureActiveDirectory`][5]
: Represents logs generated by Azure Active Directory (Azure AD), Microsoft's cloud-based identity and access management service. Azure AD logs provide insights into user sign-in activities, directory and group management, application access, and security-related events. It enables organizations to manage user access and detect potential security risks.

[`Audit.Exchange`][6]
: Pertains to logs generated by Microsoft Exchange Server. Exchange logs contain information about email delivery, mailbox access, client connections, and administrative actions within the Exchange environment. It helps organizations monitor and troubleshoot email-related issues.

[`Audit.General`][7]
: Contains information about various activities and events occurring within your Microsoft 365 environment, such as user and admin activities, system events, security incidents, and other actions that are not directly associated with specific services like Exchange or SharePoint.

[`Audit.MicrosoftForms`][8]
: Represents logs generated by Microsoft Forms, a tool for creating surveys, quizzes, and forms. Forms logs include information about form creation, access, responses, and user activities. It assists organizations in tracking and securing their forms data.

[`Audit.MicrosoftStream`][9]
: Refers to logs generated by Microsoft Stream, a video-sharing platform within the Microsoft ecosystem. Stream logs contain information about video uploads, access, sharing, and user activities. It helps organizations track and secure their video content.

[`Audit.MicrosoftTeams`][10]
: Encompasses logs produced by Microsoft Teams, a collaboration and communication platform. Teams logs include information about user activities, team and channel management, file sharing, and meeting events. It assists organizations in monitoring user interactions and ensuring secure collaboration.

[`Audit.OneDrive`][11]
: Refers to logs generated by OneDrive, Microsoft's cloud-based file storage and synchronization service. OneDrive logs include information about file access, sharing, modifications, and user activities. It helps organizations monitor and secure their cloud-based data.

[`Audit.PowerBI`][12]
: Refers to logs produced by Power BI, Microsoft's business analytics and data visualization tool. Power BI logs contain information about data access, report generation, dashboard activities, and user interactions. It helps organizations monitor and secure their business intelligence data.

[`Audit.Project`][13]
: Refers to the audit logs for Microsoft Project, a project management tool within the Microsoft 365 suite. These logs capture events related to user activities, administrative actions, and system events within Microsoft Project, such as project creation, task updates, resource allocation, and permission changes.

[`Audit.SharePoint`][14]
: Refers to logs produced by Microsoft SharePoint. SharePoint logs record user access, document modifications, site administration, and security-related events. It enables organizations to maintain data integrity and secure their SharePoint sites and content.

[`Audit.SkypeForBusiness`][15]
: Refers to the audit logs for Skype for Business activities. These logs capture events related to user and administrative actions within the Skype for Business service, such as call detail records, conference detail records, messaging activities, and admin actions like user management and policy updates.

[`Audit.Yammer`][16]
: Represents logs produced by Yammer, a social networking platform for enterprises. Yammer logs include information about user activities, group and community management, and content sharing. It helps organizations monitor and secure their internal social networks.

[`ComplianceManager`][17]
: Related to the Microsoft Compliance Manager tool, which helps organizations assess, manage, and track their compliance activities in Microsoft 365. These logs contain information about compliance assessments, tasks, improvement actions, and progress towards meeting regulatory requirements.

`DLP.All`
: Captures events related to DLP policies, detections, and actions across all Microsoft 365 services, including Exchange, SharePoint, OneDrive, Microsoft Teams, and others. These logs provide insights into policy violations, sensitive information detections, and the actions taken to protect the data, such as blocking content, notifying users or administrators, and more.

`Dynamics365`
: Collect events from any of your [Microsoft Dynamics 365][18] services and applications.

[`MicrosoftFlow`][19]
: Associated with the Microsoft Power Automate service (formerly known as Microsoft Flow), a cloud-based platform that allows users to create and manage automated workflows between various applications and services. These logs capture events related to workflow runs, errors, and administrative actions, such as creating, updating, or deleting flows.

[`Mip`][20]
: Pertains to logs generated by Microsoft Information Protection (MIP), a suite of tools and services for classifying, labeling, and protecting sensitive data. MIP logs provide insights into data classification, access, and protection events. It enables organizations to manage and secure their sensitive information.

[`MyAnalytics`][21]
: Related to the Microsoft MyAnalytics service, which provides insights into an individual's work habits and productivity trends within the Microsoft 365 suite. These logs contain information about users' activities, such as time spent on meetings, emails, collaboration, and focus time.

[`PowerApps`][22]
: Refers to logs generated by Power Apps, Microsoft's low-code application development platform. Power Apps logs contain information about app creation, access, usage, and user activities.

[`Quarantine`][23]
: Represents logs generated by email quarantine systems used to isolate and review potentially malicious or unwanted emails. Quarantine logs include information about quarantined emails, sender and recipient details, and actions taken. It assists organizations in managing email security and preventing threats.

[`Rdl`][24]
: Related to SQL Server Reporting Services (SSRS), a server-based reporting platform that allows users to create, publish, and manage reports in various formats. The Rdl log source captures events related to report execution, access, and administrative actions, such as generating, updating, or deleting reports.

[`SecurityComplianceCenter`][25]
: Pertains to logs generated by Microsoft's Security & Compliance Center, a centralized platform for managing security and compliance features across Microsoft 365 services. These logs provide insights into security incidents, policy violations, and compliance management activities. It helps organizations maintain a secure and compliant IT environment.

[`SecurityMonitoringEntityReducer`][26]
: Associated with security event logs and alert aggregation activities in Microsoft 365. These logs provide insights into security events, anomalies, and potential threats detected across the Microsoft 365 environment.

[`ThreatIntelligence`][27]
: Encompasses logs generated by threat intelligence systems or tools that collect, analyze, and share information about emerging security threats. Threat intelligence logs provide insights into potential threats, vulnerabilities, and indicators of compromise. It helps organizations proactively defend against cyberattacks.

</details>

See [Office 365 Management API schemas][3] for the full list of potential log sources.

### Security

You can use Datadog's [Cloud SIEM][28] to detect real-time threats in your environment with Microsoft 365 audit logs. See the full list of [out-of-the-box Microsoft 365 detection rules][29] or [create a custom detection rule][30].

{{< img src="integrations/microsoft_365/microsoft_365_rules.png" alt="The out of the box security rules page with Cloud SIEM selected and Microsoft 365 entered in the search bar" style="width:80;" popup="true">}}

### メトリクス

The Microsoft 365 integration does not collect any metrics.

### Service checks

The Microsoft 365 integration does not collect any service checks.

## トラブルシューティング

Datadog's log intake only supports backdating log events up to 18 hours in the past. Log events with an earlier timestamp are discarded.

Datadog does not support GCC government, GCC High government, or DoD tenants, because they require different Microsoft endpoints.

Need help? Contact [Datadog support][31].

## Further reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: https://app.datadoghq.com/integrations/microsoft-365
[2]: https://docs.microsoft.com/en-us/microsoft-365/compliance/turn-audit-log-search-on-or-off?view=o365-worldwide#turn-on-audit-log-search
[3]: https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema#office-365-management-api-schemas
[4]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AAirInvestigation%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[5]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AAzureActiveDirectory%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[6]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AExchange%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[7]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[8]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AMicrosoftForms%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[9]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AMicrosoftStream%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[10]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AMicrosoftTeams%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[11]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AOneDrive%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[12]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3APowerBI%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[13]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AProject%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[14]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3ASharePoint%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[15]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3ASkypeForBusiness%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[16]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AYammer%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[17]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AComplianceManager%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[18]: https://learn.microsoft.com/dynamics365/
[19]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AMicrosoftFlow%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[20]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AMip%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[21]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AMyAnalytics%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[22]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3APowerApps%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[23]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AQuarantine%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[24]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3ARdl%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[25]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3ASecurityComplianceCenter%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[26]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3ASecurityMonitoringEntityReducer%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[27]: https://app.datadoghq.com/logs?query=source%3Amicrosoft-365%20service%3AThreatIntelligence%20&cols=host%2Cservice&index=%2A&messageDisplay=inline&stream_sort=desc&viz=stream&live=true
[28]: https://docs.datadoghq.com/security/#cloud-siem
[29]: https://docs.datadoghq.com/security/default_rules/?category=cat-cloud-siem-log-detection&search=microsoft+365
[30]: https://docs.datadoghq.com/security/detection_rules/#create-detection-rules
[31]: https://docs.datadoghq.com/help/

