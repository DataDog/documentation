---
"aliases":
- /integrations/awsxray/
"categories":
- aws
- cloud
- tracing
"custom_kind": "integration"
"dependencies": []
"description": "Trace requests as they move through your AWS services"
"doc_link": "https://docs.datadoghq.com/integrations/amazon_xray/"
"draft": false
"git_integration_title": "amazon_xray"
"has_logo": true
"integration_id": ""
"integration_title": "AWS X-Ray"
"integration_version": ""
"is_public": true
"manifest_version": "1.0"
"name": "amazon_xray"
"public_title": "Datadog-AWS X-Ray Integration"
"short_description": "Trace requests as they move through your AWS services"
"version": "1.0"
---

<!--  SOURCED FROM https://github.com/DataDog/dogweb -->
{{< site-region region="gov" >}}
<div class="alert alert-warning">The Datadog AWS Lambda X-Ray integration is only supported on commercial AWS accounts. Without a commercial Lambda account, the Datadog AWS Lambda X-Ray integration is not supported on the Datadog for Government site.</div>

{{< /site-region >}}
## Overview

AWS X-Ray lets developers trace distributed applications built using AWS products. This integration provides traces for Lambda functions in the [Serverless][1] function detail page. For more information, see [Serverless monitoring][2].

## Setup

### Installation

First, [enable the AWS integration][3] and ensure the following permissions are present in the policy document of your Datadog integration role:

```text
xray:BatchGetTraces,
xray:GetTraceSummaries
```

The `GetTraceSummaries` permission is used to get the list of recent traces. `BatchGetTraces` actually returns the full traces themselves.

Then, [enable the X-Ray integration][4] within Datadog.

If you are using a [Customer Master Key (CMK)][5] to encrypt traces, add the `kms:Decrypt` method to your policy where the Resource is the CMK used for X-Ray.

**Note:** Enabling the AWS X-Ray integration increases the amount of Indexed Spans which can impact your bill.

### Enabling AWS X-Ray for your functions

1. Follow instructions from AWS to enable X-Ray tracing on your [Lambda functions][6] and [API Gateways][7]. 
2. To get the most out of the AWS X-Ray integration, also [install the X-Ray SDK][8] in your Lambda function.

### Enrich X-Ray traces with Datadog

Datadog can enrich X-Ray traces with spans and metadata generated by the Datadog APM client, and [merge][9] them into a single Datadog trace for the same Lambda invocation.

1. [Install Datadog serverless monitoring][10] on your Lambda functions.
2. Set the environment variable `DD_MERGE_XRAY_TRACES` to `true` on your Lambda functions.

## Data Collected

The AWS X-Ray integration pulls in trace data from AWS, and does not collect any metrics or logs.

[1]: http://app.datadoghq.com/functions
[2]: https://docs.datadoghq.com/serverless/
[3]: https://docs.datadoghq.com/integrations/amazon_web_services/
[4]: https://app.datadoghq.com/integrations/amazon-xray
[5]: https://docs.aws.amazon.com/whitepapers/latest/kms-best-practices/customer-master-keys.html
[6]: https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html
[7]: https://docs.aws.amazon.com/xray/latest/devguide/xray-services-apigateway.html
[8]: https://docs.aws.amazon.com/xray/latest/devguide/xray-instrumenting-your-app.html#xray-instrumenting-xray-sdk
[9]: https://docs.datadoghq.com/serverless/distributed_tracing/serverless_trace_merging
[10]: https://docs.datadoghq.com/serverless/installation

