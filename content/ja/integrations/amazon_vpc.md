---
aliases: []
categories:
- aws
- cloud
- log collection
- network
custom_kind: インテグレーション
dependencies: []
description: Gather your Amazon VPC logs.
doc_link: https://docs.datadoghq.com/integrations/amazon_vpc/
draft: false
further_reading:
- link: https://www.datadoghq.com/blog/vpc-security-flowlogs/
  tag: Blog
  text: Monitor flow logs to ensure VPC security with Datadog
git_integration_title: amazon_vpc
has_logo: false
integration_id: ''
integration_title: Amazon VPC
integration_version: ''
is_public: true
manifest_version: '1.0'
name: amazon_vpc
public_title: Datadog-Amazon VPC Integration
short_description: Gather your Amazon VPC logs.
version: '1.0'
---

<!--  SOURCED FROM https://github.com/DataDog/dogweb -->
## Overview

Amazon Virtual Private Cloud (Amazon VPC) enables you to launch AWS resources into your virtual network. VPC Flow Logs is a feature that allows you to capture information about the IP traffic going to and from network interfaces in your VPC.

## セットアップ

### インストール

If you haven't already, set up the [Amazon Web Services integration][1] first.

### Metric collection

There are no additional steps required to collect non-`aws.vpc.flowlogs.*` Amazon VPC metrics. Metrics prefixed with `aws.vpc.flowlogs.*` are generated by the [Datadog VPC Flow Logs][2] integration. See the [log collection](#log-collection) section below to enable flow logs metrics collection.

For `aws.vpc.subnet.*` metrics, contact [Datadog support][3] to enable collection for your account.

### Log collection


#### Find or create the destination resource in AWS for your VPC flow logs

VPC flow logs must first be sent to an intermediate destination before being sent to Datadog. You can send them directly to a Amazon Data Firehose, or they can be stored in an S3 bucket or a CloudWatch Log group.

Amazon Data Firehose is the recommended option for sending VPC flow logs to Datadog because it has less operational overhead and can be more cost-effective. Read [Introducing Amazon VPC Flow Logs to Kinesis Data Firehose][4] for more information.

1. Create a new or choose an existing:
   - Amazon Data Firehose (recommended). If you don't already have an existing Amazon Data Firehose delivery stream for sending logs to Datadog, follow the instructions in the [Send AWS services logs with the Datadog Amazon Firehose Destination][5] guide to create one. **Note:** You can optionally choose a delivery stream in another AWS account separate from your VPC for centralized log collection and delivery.
   - S3 bucket or folder path.
   - CloudWatch Log group.

**Note**: Specify `vpc` as the prefix for the S3 path or CloudWatch log group name to have the Lambda automatically tag the `vpc` source on the logs.


#### Enable VPC flow log logging

1. In the AWS console, go to the VPC you want to monitor.
2. Go to the **Flow logs** tab. 
3. Click **Create flow log**.
4. Select the `All` filter to get both accepted and rejected connections.
5. Select the desired destination type (Amazon Data Firehose, S3 bucket, or CloudWatch log group) for the logs.
6. Fill in the details for the destination resource.
7. Click **Create flow log**.

#### Send logs to Datadog

If you selected Amazon Data Firehose as your destination, you are done!

If you selected an S3 bucket or the CloudWatch log group as your destination:

1. If you haven't already, set up the [Datadog Forwarder Lambda function][6] in your AWS account.
2. Once set up, go to the Datadog Forwarder Lambda function. In the Function Overview section, click **Add Trigger**. 
3. Select the **S3** or **CloudWatch Logs** trigger for the Trigger Configuration.
4. Select the S3 bucket or CloudWatch log group that contains your VPC logs.
5. For S3, leave the event type as `All object create events`.
6. Click **Add** to add the trigger to your Lambda.

Go to the [Log Explorer][7] to start exploring your logs.

For more information on collecting AWS Services logs, see [Send AWS Services Logs with the Datadog Lambda Function][8].

## データ収集

### メトリクス
{{< get-metrics-from-git "amazon_vpc" >}}


Each of the metrics retrieved from AWS is assigned the same tags that appear in the AWS console, including but not limited to host name, security-groups, and more.

### イベント

The Amazon VPC integration does not include any events.

### サービスチェック

The Amazon VPC integration does not include any service checks.

## トラブルシューティング

Need help? Contact [Datadog support][3].

## Further reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: https://docs.datadoghq.com/ja/integrations/amazon_web_services/
[2]: https://serverlessrepo.aws.amazon.com/applications/arn:aws:serverlessrepo:us-east-1:464622532012:applications~Datadog-VPC-Flow-Logs
[3]: https://docs.datadoghq.com/ja/help/
[4]: https://aws.amazon.com/blogs/networking-and-content-delivery/introducing-amazon-vpc-flow-logs-kinesis-data-firehose/
[5]: https://docs.datadoghq.com/ja/logs/guide/send-aws-services-logs-with-the-datadog-kinesis-firehose-destination/
[6]: https://docs.datadoghq.com/ja/logs/guide/forwarder/
[7]: https://docs.datadoghq.com/ja/logs/explorer/
[8]: https://docs.datadoghq.com/ja/logs/guide/send-aws-services-logs-with-the-datadog-lambda-function/
[9]: https://github.com/DataDog/dogweb/blob/prod/integration/amazon_vpc/amazon_vpc_metadata.csv