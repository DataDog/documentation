---
title: Instrumenting .NET Applications
kind: documentation
further_reading:
- link: 'serverless/serverless_tagging/'
  tag: "Serverless"
  text: 'Tagging Serverless Applications'
- link: 'serverless/distributed_tracing/'
  tag: "Serverless"
  text: 'Tracing Serverless Applications'
- link: 'serverless/custom_metrics/'
  tag: "Serverless"
  text: 'Submitting Custom Metrics from Serverless Applications'
---

## Required setup

If not already configured, install the [AWS integration][1]. This allows Datadog to ingest Lambda metrics from AWS. After you have installed the [AWS integration][1], follow these steps to instrument your application to send metrics, logs, and traces to Datadog.

## Configuration

### Install the Datadog Lambda Extension

Install the [Datadog Lambda Extension][2] as a Lambda Layer on your Lambda function using the ARN in the following format:

```
arn:aws:lambda:<AWS_REGION>:464622532012:layer:Datadog-Extension:<EXTENSION_VERSION>
```

The latest `EXTENSION_VERSION` is `{{< latest-lambda-layer-version layer="extension" >}}`.

### Configure the function

1. Enable [AWS X-Ray active tracing][4] for your Lambda function.
2. Install the [AWS X-Ray SDK for .NET][5].
3. Add the environment variable `DD_API_KEY` and set the value to your Datadog API key on the [API Management page][6]. 

## Explore Datadog serverless monitoring

After you have configured your function following the steps above, you should be able to view metrics, logs and traces on the [Serverless homepage][7].

### Tag

Although it's optional, Datadog highly recommends tagging you serverless applications with the `env`, `service`, and `version` tags following the [unified service tagging documentation][8].

### Collect logs from AWS serverless resources

Serverless logs generated by managed resources besides AWS Lambda functions can be hugely valuable in helping identify the root cause of issues in your serverless applications. We recommend you forward logs from the following managed resources in your environment:
- API's: API Gateway, AppSync, ALB
- Queues & Streams: SQS, SNS, Kinesis
- Data Stores: DynamoDB, S3, RDS, etc.

To collect logs from non-Lambda AWS resources, install and configure the [Datadog Forwarder][9] to subscribe to each of your managed resource CloudWatch log groups.

### Monitor custom business logic

If you would like to submit a custom metric, see the sample code below:

```csharp
var myMetric = new Dictionary<string, object>();
myMetric.Add("m", "coffee_house.order_value");
myMetric.Add("v", 12.45);
myMetric.Add("e", (int)(DateTime.UtcNow - new DateTime(1970, 1, 1)).TotalSeconds);
myMetric.Add("t", new string[] {"product:latte", "order:online"});
LambdaLogger.Log(JsonConvert.SerializeObject(myMetric));
```

For more information on custom metric submission, see [here][10].

## Further Reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: /integrations/amazon_web_services/
[2]: /serverless/libraries_integrations/extension/
[3]: https://gallery.ecr.aws/datadog/lambda-extension
[4]: https://docs.aws.amazon.com/xray/latest/devguide/xray-services-lambda.html
[5]: https://docs.aws.amazon.com/xray/latest/devguide/xray-sdk-dotnet.html
[6]: https://app.datadoghq.com/account/settings#api
[7]: https://app.datadoghq.com/functions
[8]: /getting_started/tagging/unified_service_tagging/#aws-lambda-functions
[9]: /serverless/libraries_integrations/forwarder
[10]: /serverless/custom_metrics?tab=otherruntimes
