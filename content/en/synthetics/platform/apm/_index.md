---
title: Synthetic APM
description: APM and Distributed Tracing with Synthetic Monitoring
aliases:
- /synthetics/apm
further_reading:
  - link: "https://www.datadoghq.com/blog/introducing-synthetic-monitoring/"
    tag: "Blog"
    text: "Introducing Datadog Synthetic Monitoring"
  - link: "/tracing/"
    tag: "Documentation"
    text: "APM and Distributed Tracing"
  - link: '/logs/guide/ease-troubleshooting-with-cross-product-correlation/'
    tag: 'Guide'
    text: 'Ease troubleshooting with cross product correlation.'

---

{{< img src="synthetics/apm/synthetics-apm.mp4" alt="APM and Synthetic Monitoring" video="true" >}}

## Overview

The APM integration with Synthetic Monitoring allows you to go from a test run that potentially failed to the root cause of the issue by looking at the trace generated by that test run.

Having network-related specifics (thanks to your test) as well as backend, infrastructure, and log information (thanks to your trace) allows you to access a new level of details about the way your application is behaving, as experienced by your user.

## Usage

Statements on this page apply to [HTTP API tests][1], [Multistep API tests][2], and [browser tests][3] for APM.

### Prerequisites

* Your service, and the endpoint your test is running on, is [traced on the APM side][4].
* Your service uses an HTTP server.
* Your HTTP server is using a library that supports distributed tracing.

Create a test that hits your traced HTTP server, and Datadog automatically links the trace generated by your server to the corresponding test result.

To link browser test results, allow the URLs you want the APM integration headers added to. You can do this in [Synthetic Settings][5]. Use `*` for wildcards:

```text
https://*.datadoghq.com/*
```

## Supported libraries

The following Datadog tracing libraries are supported:

| Library                             | Minimum Version                                                                                                             |
|----------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| [Python][6]                  | [0.50.4][7]                |
| [Go][8]                  | [1.10.0][9]                |
| [Java][10]                  | [0.24.1][11]                |
| [Ruby][12]                  | [0.20.0][13]                |
| [Node.js][14]                  | [0.10.0][15]                |
| [PHP][16]                  | [0.33.0][17]                |
| [.NET][18]                  | [1.18.2][19]                |

### How are traces linked to tests?

Datadog uses the distributed tracing protocol and sets up the following HTTP headers:


{{< tabs >}}
{{% tab "Datadog" %}}
`x-datadog-trace-id`
: Generated from the Synthetic Monitoring backend. Allows Datadog to link the trace with the test result.

`x-datadog-parent-id: 0`
: To have Synthetic tests be the root span of the generated trace.

`x-datadog-origin: synthetics`
: To identify generated traces from your API tests. Spans from these traces are tagged with `ingestion_reason:synthetics`.

`x-datadog-origin: synthetics-browser`
: To identify generated traces from your Browser tests. These traces are tagged with `ingestion_reason:synthetics-browser`.

`x-datadog-sampling-priority: 1`
: To make sure that the Agent keeps the trace.
{{% /tab %}}
{{% tab "W3C Trace Context" %}}
`traceparent: [version]-[trace id]-[parent id]-[trace flags]`
: `version`: The specification assumes version is set to `00`.
: `trace id`: 128 bits trace ID, hexadecimal on 32 characters. The source trace ID is 64 bits to maintain compatibility with APM.
: `parent id`: 64 bits span ID, hexadecimal on 16 characters.
: `trace flags`: Sampled (`01`) or not sampled (`00`)

**Example**:
: `traceparent: 00-00000000000000008448eb211c80319c-b7ad6b7169203331s-01`
{{% /tab %}}
{{< /tabs >}}

### How long are traces retained?

These traces are retained for 15 days with the `Synthetics Default` retention filter, [just like your classical APM traces][20].

## Further Reading

{{< partial name="whats-next/whats-next.html" >}}



[1]: /synthetics/api_tests/http_tests/?tab=requestoptions
[2]: /synthetics/multistep?tab=requestoptions
[3]: /synthetics/browser_tests/
[4]: /tracing/
[5]: https://app.datadoghq.com/synthetics/settings/integrations
[6]: /tracing/trace_collection/dd_libraries/python/
[7]: https://github.com/DataDog/dd-trace-py/releases/tag/v0.50.4
[8]: /tracing/trace_collection/dd_libraries/go/
[9]: https://github.com/DataDog/dd-trace-go/releases/tag/v1.10.0
[10]: /tracing/trace_collection/dd_libraries/java/
[11]: https://github.com/DataDog/dd-trace-java/releases/tag/v0.24.1
[12]: /tracing/trace_collection/dd_libraries/ruby/
[13]: https://github.com/DataDog/dd-trace-rb/releases/tag/v0.20.0
[14]: /tracing/trace_collection/dd_libraries/nodejs/
[15]: https://github.com/DataDog/dd-trace-js/releases/tag/v0.10.0
[16]: /tracing/trace_collection/dd_libraries/php/
[17]: https://github.com/DataDog/dd-trace-php/releases/tag/0.33.0
[18]: /tracing/trace_collection/dd_libraries/dotnet-core/
[19]: https://github.com/DataDog/dd-trace-dotnet/releases/tag/v1.18.2
[20]: /tracing/trace_pipeline/trace_retention/
