---
title: Workload Protection Agent advanced configuration
disable_toc: false
---

The Workload Protection Agent has several configuration knobs that can be used to tweak the agent and its behavior. You'll find below the list of available parameters for both `system-probe` and the `security-agent`, two components that are required for Workload Protection to function properly.

## `security-agent` configuration parameters

<div class="alert alert-info">Parameters can be provided in 2 different manners: through environment variables (given to the Datadog Agent container for example) or by editing the `/etc/datadog-agent/security-agent.yaml` configuration file.</div>

| Environment variable                  | `security-agent.yaml` attribute    | Value                               | Description                                                                                                                             |
|---------------------------------------|------------------------------------|-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| `DD_RUNTIME_SECURITY_CONFIG_ENABLED`  | `runtime_security_config.enabled`  | `true` / `false` (default: `false`) | Enables Workload Protection. Follow the [Getting started][1] guide for more about getting the Workload Protection agent up and running. |

## `system-probe` configuration parameters

<div class="alert alert-info">Parameters can be provided in 2 different manners: through environment variables (given to the Datadog Agent container for example) or by editing the `/etc/datadog-agent/system-probe.yaml` configuration file.</div>

| Environment variable                                                     | `system-probe.yaml` attribute                                         | Value                                                                            | Description                                                                                                                                                                                                                                                            |
|--------------------------------------------------------------------------|-----------------------------------------------------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `DD_RUNTIME_SECURITY_CONFIG_ENABLED`                                     | `runtime_security_config.enabled`                                     | `true` / `false` (default: `false`)                                              | Enables Workload Protection. Follow the [Getting started][1] guide for more about getting the Workload Protection agent up and running.                                                                                                                                |
| `DD_RUNTIME_SECURITY_CONFIG_SELF_TEST_ENABLED`                           | `runtime_security_config.self_test.enabled`                           | `true` / `false` (default: `true`)                                               | Runs self-tests on startup to make sure the environment is supported. A report is sent to Datadog for monitoring.                                                                                                                                                      |
| `DD_RUNTIME_SECURITY_CONFIG_REMOTE_CONFIGURATION_ENABLED`                | `runtime_security_config.remote_configuration.enabled`                | `true` / `false` (default: `true`)                                               | Enables Remote Configuration for automatic updates of default Agent rules and remote deployment of custom Agent rules.                                                                                                                                                 |
| `DD_RUNTIME_SECURITY_CONFIG_DIRECT_SEND_FROM_SYSTEM_PROBE`               | `runtime_security_config.direct_send_from_system_probe`               | `true` / `false` (default: `false`)                                              | Sends events to Datadog directly without forwarding them to the `security-agent`.                                                                                                                                                                                      |
| `DD_RUNTIME_SECURITY_CONFIG_CONTAINER_EXCLUDE`                           | `runtime_security_config.container_exclude`                           | List of `[image_name]:[image_tag]` (default: ``)                                 | List of container images that shouldn't be monitored by Workload Protection.                                                                                                                                                                                           |
| `DD_RUNTIME_SECURITY_CONFIG_CONTAINER_INCLUDE`                           | `runtime_security_config.container_include`                           | List of `[image_name]:[image_tag]` (default: ``)                                 | List of container images that should be monitored by Workload Protection. Inclusion takes precedence over exclusion.                                                                                                                                                   |
| `DD_RUNTIME_SECURITY_CONFIG_EXCLUDE_PAUSE_CONTAINER`                     | `runtime_security_config.exclude_pause_container`                     | `true` / `false` (default: `true`)                                               | Exclude `pause` containers by default.                                                                                                                                                                                                                                 |
| `DD_RUNTIME_SECURITY_CONFIG_SBOM_ENABLED`                                | `runtime_security_config.sbom.enabled`                                | `true` / `false` (default: `false`)                                              | Collect SBOM from monitored containers to enrich Workload Protection events with package management metadata.                                                                                                                                                          |
| `DD_RUNTIME_SECURITY_CONFIG_SBOM_HOST_ENABLED`                           | `runtime_security_config.sbom.host.enabled`                           | `true` / `false` (default: `false`)                                              | Collect SBOM from the host on which the agent is running to enrich Workload Protection events with package management metadata.                                                                                                                                        |
| `DD_RUNTIME_SECURITY_CONFIG_HASH_RESOLVER_ENABLED`                       | `runtime_security_config.hash_resolver.enabled`                       | `true` / `false` (default: `true`)                                               | Global toggle to allow or prevent computing file hashes to enrich Workload Protection events.                                                                                                                                                                          |
| `DD_RUNTIME_SECURITY_CONFIG_HASH_RESOLVER_EVENT_TYPES`                   | `runtime_security_config.hash_resolver.event_types`                   | List of `[event_type]` (default: `["exec", "open"]`)                             | Specifies which event types are eligible for hash computation. Hashes are generated either through a SecL hash action or automatically for events flagged as anomaly detection.                                                                                        |
| `DD_RUNTIME_SECURITY_CONFIG_HASH_RESOLVER_MAX_FILE_SIZE`                 | `runtime_security_config.hash_resolver.max_file_size`                 | Number of bytes (default: `(1<<20)*10`, i.e. 10MB)                               | Defines the maximum size (in bytes) of the files that may be hashed.                                                                                                                                                                                                   |
| `DD_RUNTIME_SECURITY_CONFIG_HASH_RESOLVER_MAX_HASH_RATE`                 | `runtime_security_config.hash_resolver.max_hash_rate`                 | Number of files per second (default: `500`)                                      | Defines the maximum number of files that may be hashed per second.                                                                                                                                                                                                     |
| `DD_RUNTIME_SECURITY_CONFIG_HASH_RESOLVER_HASH_ALGORITHMS`               | `runtime_security_config.hash_resolver.hash_algorithms`               | List of hash algorithms to compute (default: `["sha1", "sha256", "ssdeep"]`)     | Defines the algorithms used to compute the file hashes. All algorithm listed will be computed. Options are: `sha1`, `sha256`, `md5` and `ssdeep`.                                                                                                                      |
| `DD_RUNTIME_SECURITY_CONFIG_SYSCTL_ENABLED`                              | `runtime_security_config.sysctl.enabled`                              | `true` / `false` (default: `true`)                                               | Global toggle to allow or prevent collecting `sysctl` related telemetry.                                                                                                                                                                                               |
| `DD_RUNTIME_SECURITY_CONFIG_SYSCTL_EBPF_ENABLED`                         | `runtime_security_config.sysctl.ebpf.enabled`                         | `true` / `false` (default: `true`)                                               | Enables the `sysctl` SecL event type that captures accesses and modifications of system parameters at runtime.                                                                                                                                                         |
| `DD_RUNTIME_SECURITY_CONFIG_SYSCTL_SNAPSHOT_ENABLED`                     | `runtime_security_config.sysctl.snapshot.enabled`                     | `true` / `false` (default: `true`)                                               | Enables the periodic collection of all security relevant `sysctl` parameters by generating a `sysctl_snapshot` event.                                                                                                                                                  |
| `DD_RUNTIME_SECURITY_CONFIG_SYSCTL_SNAPSHOT_PERIOD`                      | `runtime_security_config.sysctl.snapshot.period`                      | Duration in the Golang format (default: `1h`)                                    | Defines how often a new snapshot of all security relevant `sysctl` parameters should be generated.                                                                                                                                                                     |
| `DD_RUNTIME_SECURITY_CONFIG_SYSCTL_SNAPSHOT_IGNORED_BASE_NAMES`          | `runtime_security_config.sysctl.snapshot.ignored_base_names`          | The list of `sysctl` base names (default: `["netdev_rss_key", "stable_secret"]`) | The list of `sysctl` base names that should be ignore during a `sysctl` snapshot.                                                                                                                                                                                      |
| `DD_RUNTIME_SECURITY_CONFIG_EBPFLESS_ENABLED`                            | `runtime_security_config.ebpfless.enabled`                            | `true` / `false` (default: `false`)                                              | Enables the eBPF-less mode of Workload Protection. Follow the [Getting started][1] guide for more about getting the Workload Protection agent up and running.                                                                                                          |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_ENABLED`                         | `runtime_security_config.enforcement.enabled`                         | `true` / `false` (default: `true`)                                               | Global toggle defining if the enforcement capability should be enabled.                                                                                                                                                                                                |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_EXCLUDE_BINARIES`                | `runtime_security_config.enforcement.exclude_binaries`                | List of glob patterns (default: ``)                                              | List of glob patterns matching the binary paths of the processes that should never be killed by the agent.                                                                                                                                                             |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_DISARMER_CONTAINER_ENABLED`      | `runtime_security_config.enforcement.disarmer.container.enabled`      | `true` / `false` (default: `false`)                                              | Defines if an enforcement rule should be disarmed when hitting too many different containers.                                                                                                                                                                          |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_DISARMER_CONTAINER_MAX_ALLOWED`  | `runtime_security_config.enforcement.disarmer.container.max_allowed`  | Count of container (default: `5`)                                                | Defines the maximum number of different containers that can trigger an enforcement rule within the configured period before enforcement is disarmed for this rule.                                                                                                     |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_DISARMER_CONTAINER_PERIOD`       | `runtime_security_config.enforcement.disarmer.container.period`       | Duration in the Golang format (default: `1m`)                                    | Defines the period during which the containers affected by an enforcement rule are counted.                                                                                                                                                                            |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_DISARMER_EXECUTABLE_ENABLED`     | `runtime_security_config.enforcement.disarmer.executable.enabled`     | `true` / `false` (default: `false`)                                              | Defines if an enforcement rule should be disarmed when hitting too many different executables.                                                                                                                                                                         |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_DISARMER_EXECUTABLE_MAX_ALLOWED` | `runtime_security_config.enforcement.disarmer.executable.max_allowed` | Count of executables (default: `5`)                                              | Defines the maximum number of different executables that can trigger an enforcement rule within the configured period before enforcement is disarmed for this rule.                                                                                                    |
| `DD_RUNTIME_SECURITY_CONFIG_ENFORCEMENT_DISARMER_EXECUTABLE_PERIOD`      | `runtime_security_config.enforcement.disarmer.executable.period`      | Duration in the Golang format (default: `1m`)                                    | Defines the period during which the executables affected by an enforcement rule are counted.                                                                                                                                                                           |
| `DD_EVENT_MONITOR_CONFIG_CUSTOM_SENSITIVE_WORDS`                         | `event_monitoring_config.custom_sensitive_words`                      | List of words (default: ``)                                                      | Defines a list of  sensitive words from which will be derived regexp designed to scrub sensitive data. For example: the command line argument key used to pass sensitive tokens, etc                                                                                   |
| `DD_EVENT_MONITOR_CONFIG_CUSTOM_SENSITIVE_REGEXPS`                       | `event_monitoring_config.custom_sensitive_regexps`                    | List of regexp (default: ``)                                                     | Defines a list of  regular expressions that will be used to scrub sensitive data. For example: api key patterns, etc                                                                                                                                                   |
| `DD_EVENT_MONITOR_CONFIG_CUSTOM_SENSITIVE_REGEXPS`                       | `event_monitoring_config.custom_sensitive_regexps`                    | List of regexp (default: ``)                                                     | Defines a list of  regular expressions that will be used to scrub sensitive data. For example: api key patterns, etc                                                                                                                                                   |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_ENABLED`                                | `event_monitoring_config.network.enabled`                             | `true` / `false` (default: `true`)                                               | Global toggle allowing Workload Protection to inject its eBPF network probes (using Traffic Control classifiers).                                                                                                                                                      |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_INGRESS_ENABLED`                        | `event_monitoring_config.network.ingress.enabled`                     | `true` / `false` (default: `true`)                                               | Defines if Workload Protection should hook on ingress traffic (egress traffic is hooked by default).                                                                                                                                                                   |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_RAW_PACKET_ENABLED`                     | `event_monitoring_config.network.raw_packet.enabled`                  | `true` / `false` (default: `true`)                                               | Defines if Workload Protection should load and attach its raw packet eBPF programs. This is required for the `raw_packet` event type to work.                                                                                                                          |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_EXTRA_PRIVATE_IP_RANGES`                | `event_monitoring_config.network.extra_private_ip_ranges`             | List if CIDRs as defined in RFC 4632 and RFC 4291 (default: ``)                  | Defines a list of custom private IP ranges for the agent to properly classify internal VS external network traffic.                                                                                                                                                    |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_LAZY_INTERFACE_PREFIXES`                | `event_monitoring_config.network.lazy_interface_prefixes`             | List of interface name prefixes (default: `["lo", "dummy"]`)                     | List of interfaces prefixes that aren't explicitly deleted by a container runtime, and that are lazily deleted by the kernel when a network namespace is cleaned up. This list helps the agent detect when a network namespace should be purged from all caches.       |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_CLASSIFIER_PRIORITY`                    | `event_monitoring_config.network.classifier_priority`                 | Priority value (default: `10`)                                                   | Priority used by the Workload Protection Traffic Control classifiers. Feel free to change this value in case of a conflict with a third party vendor powered by eBPF.                                                                                                  |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_CLASSIFIER_HANDLE`                      | `event_monitoring_config.network.classifier_handle`                   | Handle value (default: `0`)                                                      | Handle used by the default Workload Protection Traffic Control classifier. A value of 0 means that Workload Protection will let the kernel choose a handle at runtime. Feel free to change this value in case of a conflict with a third party vendor powered by eBPF. |
| `DD_EVENT_MONITOR_CONFIG_NETWORK_RAW_CLASSIFIER_HANDLE`                  | `event_monitoring_config.network.raw_classifier_handle`               | Handle value (default: `0`)                                                      | Handle used by the Workload Protection Traffic Control "raw" classifier. A value of 0 means that Workload Protection will let the kernel choose a handle at runtime. Feel free to change this value in case of a conflict with a third party vendor powered by eBPF.   |

[1]: /account_management/rbac/permissions/