---
title: Investigate Agent Events
kind: documentation
disable_toc: false
further_reading:
  - link: "/security/default_rules/?category=cat-csm-threats#all"
    tag: "Documentation"
    text: "Explore CSM Threats detection rules"
  - link: "/security/threats/workload_security_rules"
    tag: "Documentation"
    text: "Learn how to manage CSM Threats detection rules"
  - link: "/security/notifications/"
    tag: "Documentation"
    text: "Learn more about security notifications"
  - link: "https://www.datadoghq.com/blog/datadog-csm-windows/"
    tag: "Blog"
    text: "Secure your Windows workloads with Datadog Cloud Security Management"
---


This topic explains how to use the Agent Events explorer to query and review the Datadog Agent threat detection events generated by the [out-of-the-box (OOTB) detection rules][12].

The Datadog Agent evaluates system activity on the Agent host. When activity matches an Agent rule expression, the Agent generates a detection event and passes it to the Datadog backend.

If an event matches an Agent detection rule *and* a backend Threat detection rule, a signal is created and displayed in [Signals][11] (`Agent detection rule + backend Threat detection rule = Signal`).

With the [Agent Events explorer][13], you can investigate Agent Events separately from signals. You can review the host path where the event happened, and view the event's attributes, metrics, and processes. You can also review the Agent rule that generated the event and view triage and response instructions.

## Proactively block threats with Active Protection

By default, all OOTB Agent crypto mining threat detection rules are enabled and actively monitoring for threats.

[Active Protection][18] enables you to proactively block and terminate crypto mining threats identified by the Datadog Agent threat detection rules.

## View Agent events

To view Agent events, go to the [Agent Events explorer][13].

Agent events are queried and displayed using the standard explorer controls in the Datadog [Events explorer][14]. 


## Investigate Agent events

To investigate why an event is listed on the [Agent Events explorer][13], select an event.

The event details include the attributes, [metrics][16], and [processes][15]. **Metrics** links to the host dashboard and **Processes** links to the host [process dashboard][17] and process agent installation steps.

In **Path**, the latest process tree is displayed. This gives you the best overview of what occurred by showing you all of the commands that led to the command that initiated the event. 

{{< img src="security/csm/agent_events_explorer_details.png" alt="Your image description" style="width:100%;" >}}

**Path** is often the best place to start your investigation of an event.

## Triage Agent events

To triage an event: 

1. Select the event in the **AGENT RULE** column in the [Agent Events explorer][13].
2. Select **Click to copy**.
3. Open the [OOTB rules documention][12].
4. In the search field, paste the copied rule name.
5. Select the rule from the results.
6. Review the rule **Goal**, **Strategy**, and follow the steps in **Triage and response**.


## Further Reading

{{< partial name="whats-next/whats-next.html" >}}

[11]: /security/threats/security_signals
[12]: /security/default_rules/#cat-cloud-security-management
[13]: https://app.datadoghq.com/security/agent-events
[14]: /service_management/events/explorer/
[15]: /infrastructure/process/
[16]: /metrics/
[17]: https://app.datadoghq.com/process
[18]: /security/cloud_security_management/guide/active-protection