---
title: Exploit Prevention
disable_toc: false
further_reading:
- link: "/security/application_security/"
  tag: "Documentation"
  text: "Protect against threats with Datadog Application Security Management"
- link: "/security/application_security/threats/library_configuration/"
  tag: "Documentation"
  text: "Other setup considerations and configuration options"
---


{{< callout url="https://google.com" d_toggle="modal" d_target="#signupModal" custom_class="sign-up-trigger" btn_hidden="false" header="Join the Beta!">}}
Datadog ASM Exploit Prevention is currently in beta, but you can easily request access! Use this form to submit your request today. Once approved, you can start getting creative and develop your App for you, your organization, or for publishing to the entire Datadog community alongside our other great Datadog Apps!
{{< /callout >}}

## Overview

The ASM **Exploit Prevention** capability protects your critical applications and APIs against zero-day vulnerabilities without tuning or reconfiguration:

ASM is context-aware, with a deep understanding of the application's logic, data flow, and state. 

ASM combines telemetry from the Datadog tracer with predefined heuristics to detect and block exploits with higher accuracy and without impacting legitimate traffic.

## How does Exploit Prevention work?

### Example 1: server-side request forgery

An attacker tricks the server into making unauthorized requests to internal systems or external servers, potentially leaking information or a further exploitation.

ASM Exploit Prevention checks whether an internal or external request's URL, which is partially or totally controlled by a user parameter, has been manipulated by an attacker to alter the original purpose of the request.

### Example 2: local file inclusion

An attacker exploits a vulnerable parameter to include local files from the server, potentially exposing sensitive data like configuration files or possibly enabling remote code execution.

ASM Exploit Prevention inspects all file access attempts to determine if the path has been injected and whether a restricted file is accessed.

### Example 3: SQL injection

An attacker injects malicious SQL code into a query, potentially gaining unauthorized access to the database, manipulating data, or executing administrative operations.

ASM Exploit Prevention intercepts all SQL queries to determine if a user parameter has been injected and whether the injection alters the original purpose and structure of the SQL query.

## Getting Started

### Prerequisites

- Ensure that your applications are instrumented with the Datadog tracer.
- ASM Threat Management must be enabled. See [Enabling ASM][1].
- Ensure Remote Configuration is enabled to push rule updates and In-App WAF policies. See [Enabling Remote Configuration][2].

### Library Compatibility


| Exploit Type                       | .NET             | Python           | Go               | Java, PHP, Node.js |
|------------------------------------|------------------|------------------|------------------|------------------------|
| Server-side Request Forgery (SSRF) | v2.53.0          | v2.9.0           | v1.65.0          | Avail. in Q3’ 24       |
| Local File Inclusion (LFI)         | v2.53.0          | v2.9.0           | Avail. in Q3’ 24 | Avail. in Q3’ 24       |
| SQL Injection (SQLi)               | Avail. in Q3 ‘24 | Avail. in Q3 ‘24 | Avail. in Q3 ‘24 | Avail. in Q3 ‘24       |

<div class="alert alert-info">Ruby support in scheduled for Q4 ‘24.</div>

## Enabling Exploit Prevention


1. Navigate to [In-App WAF][3] (**Security > Application Security > Protection > In-App WAF**).
2. If you have applied a Datadog managed policy to your services, then follow these steps:  
   a. Clone the policy. For example, **Managed - Block attack tools**.
    
    {{< img src="security/application_security/threats/clone-policy.png" alt="Clone the policy" width="100%" >}}
   b. Add a policy name and description.
        
    {{< img src="security/application_security/threats/clone-policy-modal.png" alt="Clone the policy" width="100%" >}}
   c. Click on the policy you created and select the **Local File Inclusion** ruleset and enable blocking for the **Local File Inclusion exploit** rule.
   
    {{< img src="security/application_security/threats/local-file-inclusion.png" alt="Local File Inclusion" width="100%" >}}
   d. Similarly, select the **Server-side Request Forgery** ruleset and enable blocking for the **Server-side request rorgery** exploit rule.
   
    {{< img src="security/application_security/threats/server-side-request-forgery.png" alt="Server-side Request Forgery exploit" width="100%" >}}
3. If you have applied a custom policy for your services, you can skip steps 2.a and 2.b for cloning a policy and directly set the Exploit Prevention rules in **blocking** mode (steps 2.c and 2.d).


## Reviewing exploit attempts in ASM

Once you have enabled Exploit Prevention, if ASM detects an exploit attempt, it proceeds to block that request. In addition, Exploit Prevention detections are always accompanied by stack traces, which provide full visibility of where the vulnerability lies in the customer's code, ensuring a clear path to remediation.

{{< img src="security/application_security/threats/exploit-prevention-detection.png" alt="Exploit Prevention detection" width="100%" >}}

In addition, ASM also generates a signal correlating all the blocked traces and isolating the attacker IP addresses that are targeting your service(s). You can take a quick action to block all attacking IPs. 

{{< img src="security/application_security/threats/signal-correlating-blocked-traces.png" alt="Your image description" width="100%" >}}

## Further Reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: /security/application_security/enabling/
[2]: /agent/remote_config/?tab=configurationyamlfile#enabling-remote-configuration
[3]: https://app.datadoghq.com/security/appsec/in-app-waf