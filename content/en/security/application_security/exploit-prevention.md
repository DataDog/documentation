---
title: Exploit Prevention
disable_toc: false
aliases:
  - /security/application_security/threats/exploit-prevention
further_reading:
- link: "/security/application_security/"
  tag: "Documentation"
  text: "Protect against threats with Datadog App and API Protection"
- link: "/security/application_security/policies/library_configuration/"
  tag: "Documentation"
  text: "Other setup considerations and configuration options"
- link: "https://www.datadoghq.com/blog/datadog-exploit-prevention/"
  tag: "Blog"
  text: "Protect your applications from zero-day attacks with Datadog Exploit Prevention"
- link: "https://www.datadoghq.com/blog/understanding-your-waf/"
  tag: "Blog"
  text: "Understanding your WAF: How to address common gaps in web application security"
---

{{< learning-center-callout header="Get real-time security guardrails for your AI apps and agents" btn_title="Join the preview" hide_image="true" btn_url="https://www.datadoghq.com/product-preview/ai-security/">}}
  AI Guard helps secure your AI apps and agents in real time against prompt injection, jailbreaking, tool misuse, and sensitive data exfiltration attacks. Try it today!
{{< /learning-center-callout >}}

## Overview

Use App and API Protection (AAP)'s **Exploit Prevention** to protect your critical applications and APIs against zero-day vulnerabilities without tuning or reconfiguration. 

With AAP's context-aware capabilities, you can gain a deep understanding of application logic, data flow, and state.

Combine telemetry from the Datadog tracer with predefined heuristics to detect and block exploits with higher accuracy, ensuring legitimate traffic remains unaffected.

This is powered by Runtime Application Self Protection (RASP), which allows you to detect and prevent attacks in real time.

For details on how Exploit Prevention differs from In-App WAF, see [Exploit Prevention vs. In-App WAF][12].

## How exploit prevention works

1. With the Datadog AAP tracing library instrumented in your applications, details are captured about every interaction within the application, including requests, code execution, and data flows.
2. When an attack payload reaches the application, AAP evaluates if the payload triggers code paths tied to known vulnerabilities.
3. If a potential exploit is detected:
   1. AAP blocks the request in real-time before it causes damage.
   2. AAP raises security signals for further investigation.
4. Exploit prevention detections are accompanied by stack traces that provide full visibility of the code location of the vulnerability, providing a clear path to remediation. 

### Example 1: Server-side request forgery

An attacker tricks the server into making unauthorized requests to internal systems or external servers, potentially leaking information or enabling further exploitation.

AAP Exploit Prevention checks whether an internal or external request's URL, which is partially or totally controlled by a user parameter, has been manipulated by an attacker to alter the original purpose of the request.

### Example 2: Local file inclusion

An attacker exploits a vulnerable parameter to include local files from the server, potentially exposing sensitive data like configuration files or possibly enabling remote code execution.

AAP Exploit Prevention inspects all file access attempts to determine if the path has been injected and whether a restricted file is accessed.

### Example 3: SQL injection

An attacker injects malicious SQL code into a query, potentially gaining unauthorized access to the database, manipulating data, or executing administrative operations.

AAP Exploit Prevention intercepts all SQL queries to determine if a user parameter has been injected and whether the injection alters the original purpose and structure of the SQL query.

## Prerequisites

- Ensure that your applications are instrumented with the Datadog tracer.
- AAP must be enabled. See [Setup][1].
- Ensure Remote Configuration is enabled to push rule updates and In-App WAF policies. See [Enabling Remote Configuration][2].

### Library Compatibility


| Exploit Type                       | [.NET][5]        | [Python][6]      | [Go][7]                 | [Java][8]        | [Node.js][9]     | [PHP][10]        | [Ruby][11]        |
|------------------------------------|------------------|------------------|-------------------------|------------------|------------------|------------------|-------------------|
| Server-side Request Forgery (SSRF) | v3.3.0           | v2.15.0          | v1.70.1                 | v1.42.0          | v5.20.0, v4.44.0 | v1.9.0           | v2.15.0           |
| Local File Inclusion (LFI)         | v3.5.0           | v2.15.0          | [orchestrion][3] v1.0.0 | v1.42.0          | v5.24.0, v4.48.0 | v1.9.0           | Not supported     |
| SQL Injection (SQLi)               | v3.4.0           | v2.16.0          | v1.70.1                 | v1.42.0          | v5.25.0, v4.49.0 | v1.9.0           | v2.15.0           |
| Command Injection                  | v3.4.0           | v2.15.0          | Not supported           | v1.45.0          | v5.25.0, v4.49.0 | Not supported    | Not supported     |


## Enabling Exploit Prevention


1. Navigate to [In-App WAF][4] (**Security > App and API Protection > Protection > In-App WAF**).
2. If you have applied a Datadog managed policy to your services, then follow these steps:

   a. Clone the policy. For example, you can use the **Managed - Block attack tools** policy.

    <!-- {{< img src="security/application_security/threats/clone-policy.png" alt="Clone the policy" width="100%" >}} -->
   b. Add a policy name and description.

    <!-- {{< img src="security/application_security/threats/clone-policy-modal.png" alt="Clone the policy" width="100%" >}} -->
   c. Click on the policy you created and select the **Local File Inclusion** ruleset. Enable blocking for the **Local File Inclusion exploit** rule.

    <!-- {{< img src="security/application_security/threats/local-file-inclusion.png" alt="Local File Inclusion" width="100%" >}} -->
   d. Similarly, select the **Server-side Request Forgery** ruleset and enable blocking for the **Server-side request forgery** exploit rule.

    <!-- {{< img src="security/application_security/threats/server-side-request-forgery.png" alt="Server-side Request Forgery exploit" width="100%" >}} -->
3. If you have applied a custom policy for your services, you can skip Steps 2.a and 2.b for cloning a policy and directly set the Exploit Prevention rules in **blocking** mode (Steps 2.c and 2.d).


## Reviewing exploit attempts in AAP

After you have enabled Exploit Prevention, if AAP detects an exploit attempt, it proceeds to block that request. Exploit Prevention detections are always accompanied by stack traces, which provide full visibility of where the vulnerability lies in your code, ensuring a clear path to remediation.

<!-- {{< img src="security/application_security/threats/exploit-prevention-detection.png" alt="Exploit Prevention detection" width="100%" >}} -->

In addition, AAP also generates a signal correlating all the blocked traces and isolating the attacker IP addresses that are targeting your service(s). You can take action by blocking all attacking IPs.

<!-- {{< img src="security/application_security/threats/signal-correlating-blocked-traces.png" alt="Your image description" width="100%" >}} -->

## Further Reading

{{< partial name="whats-next/whats-next.html" >}}

[1]: /security/application_security/setup
[2]: /tracing/guide/remote_config
[3]: /tracing/trace_collection/automatic_instrumentation/dd_libraries/go/#overview
[4]: https://app.datadoghq.com/security/appsec/in-app-waf
[5]: https://github.com/DataDog/dd-trace-dotnet
[6]: https://github.com/DataDog/dd-trace-py
[7]: https://github.com/DataDog/dd-trace-go
[8]: https://github.com/DataDog/dd-trace-java
[9]: https://github.com/DataDog/dd-trace-js
[10]: https://github.com/DataDog/dd-trace-php
[11]: https://github.com/DataDog/dd-trace-rb
[12]: /security/application_security/#exploit-prevention-vs-in-app-waf
