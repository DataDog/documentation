{{ define "main" }}
{{ $dot := . }}
{{ $scratch := .Scratch }}
{{ $workflow_bundles := sort site.Data.workflow_bundles "title" }}

{{ if eq $workflow_bundles nil }}
  {{ $err_msg := "Could not load workflow bundles data" }}

  {{ if eq hugo.Environment "development" -}}
    {{ warnf $err_msg }}
  {{ else }}
    {{ errorf $err_msg }}
  {{ end }}
{{ end }}

<div class="row">
  <div class="col-12 order-1">
      <h1 id="pagetitle">{{ .Title }}</h1>
  </div>
  <div class="col-12">
      {{ partial "breadcrumbs.html" . }}
  </div>
</div>

{{ .Content }}
{{/*
<div class="form-group clearfix">
  <input type="input" data-ref="search" class="form-control grouped-item-search mb-3 position-relative" id="keywords" placeholder="Search here" aria-label="keywords"/>
</div>
*/}}

<form id="rules">
  {{- partial "grouped-item-listings.html" (dict "context" $dot "data" $workflow_bundles) -}}
  {{/*
  <div>
    <div class="js-empty-results d-none font-semibold"></div>
    {{ range sort $workflow_bundles "name" }}
      {{ $workflow_title := .title }}
      {{ $workflow_name := .name }}
      {{ $icon_id := .icon.id }}
      {{ $logo_path := partialCached "integrations-logo.html" (dict "context" $dot "basename" $icon_id "variant" "avatar" "fallback" "cloud") $icon_id "avatar" }}

      <div class="js-group js-group-{{ $workflow_title }}" id="{{ $workflow_title | anchorize }}">
        <div class="js-group-header mb-1 d-flex align-items-center active" id="">
          <div class="js-group-header__icon d-inline font-semibold h-100 text-uppercase px-2">
            {{ if $logo_path }}
              <img src="{{ $logo_path }}" height="17" alt="{{ $workflow_title }}"/>
            {{ end }}
          </div>
          <div class="font-semibold ms-1 group-header-text">
            <span>{{ $workflow_title }}</span>
            <span class="icon-wrapper" data-anchor="#{{ $workflow_title | anchorize }}">icon</span>
            <span class="icon-wrapper d-none">{{ partial "icon" (dict "name" "check-bold" "color" "#7c3eb9" ) }}</span>
          </div>
          <div class="js-group-header__arrow">></div>
        </div>
        <div class="group-{{ $workflow_title }} mb-2 ms-4 d-none">
          {{ range $action_name, $action_data := .actions }}
            {{ $base_url := "https://app.datadoghq.com/workflow/action-catalog#/" }}
            {{ $full_url := print $base_url $workflow_name "/" $workflow_name "." $action_name }}

            <a class="mb-1 font-semibold mix js-single-rule" href="{{ $full_url }}">
              {{ if $logo_path }}
                <img src="{{ $logo_path }}" height="17" alt="{{ $workflow_name }}"/>
              {{ end }}
              <span class="ps-1">{{ .title }}</span>
              <br>
            </a>
          {{ end }}
        </div>
      </div>
    {{ end }}
  </div>
  */}}
</form>
{{ end }}
