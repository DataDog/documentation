{{ $dot := .context }}
{{ $language := .language }}

### Application Logging

{{ if eq $language ".NET" }}

You can send logs from your application in Azure App Service to Datadog in one of the following ways:

1. Use the [installation steps](#installation) above to enable APM with the Datadog APM extension, then [enable Agentless logging]({{ "/logs/log_collection/csharp/#agentless-logging-with-apm" | absLangURL }})
2. [Agentless logging with the Serilog sink]({{ "/logs/log_collection/csharp/#agentless-logging-with-serilog-sink" | absLangURL }})

Both methods allow trace ID injection, making it possible to connect logs and traces in Datadog. To enable trace ID injection with the extension, add the application setting `DD_LOGS_INJECTION:true`.

{{ else }}

Sending logs from your application in Azure App Service to Datadog requires streaming logs to Datadog directly from your app. Submitting logs with this method allows for trace ID injection, which makes it possible to connect logs and traces in Datadog.

{{ end }}

**Environment Variables for Logging**

Configure these environment variables in your Azure App Service Application Settings for optimal log collection:

| Variable | Description | Example |
|----------|-------------|---------|
| `DD_SERVICE` | Your application's service name | `my-web-app` |
| `DD_ENV` | Your application's environment | `production`, `staging`, `development` |
| `DD_LOGS_INJECTION` | Enable trace-log correlation | `true` |

**Logging Best Practices**

1. **Enable trace correlation**: Set `DD_LOGS_INJECTION=true` to correlate logs with traces
2. **Set proper service names**: Use `DD_SERVICE` to ensure logs appear with the correct service name
3. **Use structured logging**: Implement structured logging in your application for better log parsing

**Note**: Trace ID injection occurs inside your application. Azure Resource logs are generated by Azure in the management plane, and therefore do not include the trace ID.

{{ if eq $language ".NET" }}

**Code Example: Microsoft Native Logging**

Here's an example of how to set up logging in a .NET application using Microsoft.Extensions.Logging:

```csharp
using Microsoft.Extensions.Logging;

public class WeatherForecastController : ControllerBase
{
    private readonly ILogger<WeatherForecastController> _logger;

    public WeatherForecastController(ILogger<WeatherForecastController> logger)
    {
        _logger = logger;
    }

    [HttpGet]
    public IActionResult Get()
    {
        _logger.LogInformation("Processing weather forecast request");
        
        // Your business logic here
        var forecast = GetWeatherForecast();
        
        _logger.LogInformation("Weather forecast retrieved for user: {UserId}", userId);
        
        return Ok(forecast);
    }
}
```

**Program.cs Configuration**

```csharp
using Microsoft.Extensions.Logging;

var builder = WebApplication.CreateBuilder(args);

// Configure logging
builder.Logging.ClearProviders();
builder.Logging.AddConsole();
builder.Logging.AddDebug();

// Add structured logging with JSON format
builder.Logging.AddJsonConsole(options =>
{
    options.JsonWriterOptions = new JsonWriterOptions
    {
        Indented = true
    };
});

var app = builder.Build();
// ... rest of your application configuration
```

**appsettings.json Configuration**

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    },
    "Console": {
      "FormatterName": "json",
      "FormatterOptions": {
        "IncludeScopes": true,
        "TimestampFormat": "yyyy-MM-dd HH:mm:ss "
      }
    }
  }
}
```

This setup will automatically include trace correlation when `DD_LOGS_INJECTION=true` is set in your Azure App Service Application Settings.

{{ else if eq $language "Java" }}

See instructions for [Agentless logging with Java]({{ "/logs/log_collection/java/#agentless-logging" | absLangURL }}) to configure application logging for Java in Azure App Service.

{{ else if eq $language "Node.js" }}

To configure application logging for Node.js in Azure App Service, see [Agentless logging with Node.js]({{ "/logs/log_collection/nodejs/#agentless-logging" | absLangURL }}).

{{ end }} 