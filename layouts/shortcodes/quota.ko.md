할당량 프로세서는 지정한 필터와 일치하는 로그에 대한 로깅 트래픽을 측정합니다. 구성된 일일 할당량이 24시간 롤링 창 내에 충족되면 프로세서는 추가 로그를 삭제하거나 Datadog 모니터를 사용하여 경고를 보낼 수 있습니다. 총 볼륨 또는 총 이벤트 수를 추적하도록 프로세서를 구성할 수 있습니다.

예를 들어, 프로세서가 지난 24시간 동안 특정 서비스에서 천만 개의 이벤트를 수신한 후 로그를 삭제하지 않고 새 로그를 삭제하거나 알림을 트리거하도록 이 프로세서를 구성할 수 있습니다.

할당량 프로세서를 설정하려면:
1. 할당량 프로세서의 이름을 입력합니다. 파이프라인은 이름을 사용하여 작업자의 여러 Remote Configuration 배포에서 할당량을 식별합니다.
1. **필터 쿼리**를 정의합니다. 지정된 [필터 쿼리](#filter-query-syntax)와 일치하는 로그만 일일 한도에 포함됩니다.
    - 할당량 필터와 일치하고 일일 할당량 내에 있는 로그는 파이프라인의 다음 단계로 전송됩니다.
    - 할당량 필터와 일치하지 않는 로그는 파이프라인의 다음 단계로 전송됩니다.
1.  **Unit for quota** 드롭다운 메뉴에서 할당량을 `Events`의 수 또는 `Volume` (단위: 바이트)으로 측정할지 선택합니다.
1. 일일 할당량 한도를 설정하고 원하는 할당량의 크기 단위를 선택합니다.
1. 할당량에 도달했을 때 모든 이벤트를 삭제하려면 **Drop events** 체크박스를 선택합니다. 할당량에 도달했을 때 경고를 보내는 [모니터][5001]를 설정하려면 선택하지 않은 상태로 두세요.
    - 일일 할당량이 충족되고 **Drop events** 옵션이 선택된 후 할당량 필터와 일치하는 로그가 수신되면 해당 로그가 삭제됩니다. 이 경우 필터 쿼리와 일치하지 않는 로그만 파이프라인의 다음 단계로 전송됩니다.
    - 일일 할당량이 충족된 후 할당량 필터와 일치하는 로그가 수신되고  **Drop events** 옵션이 선택되지 않은 경우 해당 로그 및 필터 쿼리와 일치하지 않는 로그는 파이프라인의 다음 단계로 전송됩니다. 
1. 선택사항: 특정 서비스 또는 지역 필드에 할당량을 설정하려면 **Add Field**를 클릭합니다.
    a. 분할하려는 필드 이름을 입력합니다. 자세한 내용은 [파티션 예시](#partition-example)를 참조하세요.
        i. 파티션과 일치하는 이벤트에만 할당량을 적용하려면 **Ignore when missing**을 선택하세요. 자세한 내용은 [Ignore when missing 예시](#example-for-the-ignore-when-missing-option)를 참조하세요.
        ii. 선택사항: 분할된 필드에 다른 할당량을 설정하려면 **Overrides**를 클릭합니다.
        - CSV 구성 방법의 예를 보려면  **Download as CSV**를 클릭합니다.
        - 재정의 CSV를 끌어다 놓아 업로드합니다. *Browse**를 클릭하여 업로드할 파일을 선택할 수도 있습니다. 자세한 내용은 [재정의 예](#overrides-example)를 참조하세요. 
    b. 다른 파티션을 추가하려면 **Add Field**를 클릭합니다.

#### 예시

##### 파티션 예시

특정 서비스나 지역에 할당량을 설정하려면 **Partition by**를 사용하세요. 예를 들어 하루 10개의 이벤트에 대한 할당량을 설정하고 `service` 필드별로 이벤트를 그룹화하려면 **Partition by** 필드에 `service`를 입력하세요.

##### "ignore when missing" 옵션의 예

파티션과 일치하는 이벤트에만 할당량을 적용하려면 **Ignore when missing**를 선택하세요. 예를 들어 작업자가 다음과 같은 이벤트 세트를 수신하는 경우:

```
{"service":"a", "source":"foo", "message": "..."}
{"service":"b", "source":"bar", "message": "..."}
{"service":"b", "message": "..."}
{"source":"redis", "message": "..."}
{"message": "..."}
```

**Ignore when missing**을 선택한 다음 작업자는 다음을 수행합니다.
- `service:a` 및 `source:foo`를 사용해 로그에 대한 세트를 생성합니다.
- `service:b` 및 `source:bar`를 사용해 로그에 대한 세트를 생성합니다.
- 마지막 세 가지 이벤트를 무시합니다.

할당량은 마지막 세 개의 이벤트가 아닌 두 개의 로그 세트에 적용됩니다.

**Ignore when missing**을 선택하지 않으면 5개 이벤트 모두에 할당량이 적용됩니다.

##### 재정의 예시

`service`로 분할하고 두 개의 서비스(`a` 및 `b`)가 있는 경우 재정의를 사용하여 서로 다른 할당량을 적용할 수 있습니다. 예를 들어 `service:a`의 할당량 제한을 5,000바이트로 설정하고 `service:b`의 이벤트 수를 50개로 제한하려는 경우 재정의 규칙은 다음과 같습니다.

| 서비스 | 유형   | 한도 |
| ------- | ------ | ----- |
|  `a`    | 바이트  | 5,000 |
|  `b`    | 이벤트 | 50    |

[5001]: /ko/monitors/types/metric/?tab=threshold