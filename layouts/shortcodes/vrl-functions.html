{{ $functions := $.Site.Data.reference.functions | default (dict) }}
{{ $regexToFixMdLinks := `\[([^\[]+)\](\([^\)]+\))` }}
{{ range $category, $arrayOfFunctionObjs := $functions}}
  <h2 id="{{ $category | anchorize }}">{{ $category }} Functions</h2>
  {{ range $obj := $arrayOfFunctionObjs }}
  <div class="py-3" style="border-bottom:2px solid #DADADA">
    <h3 id="{{ $obj.name | anchorize }}">{{ $obj.name }}</h3>
    <p>{{ (replaceRE $regexToFixMdLinks "$1" $obj.description) | markdownify }}</p>
    {{ with $obj.arguments }}
      <div class="schema-table row">
        <div class="col-12">
          <div class="row table-header">
            <div class="col-2 column">
              <p class="font-semibold"> {{ i18n "argument" | default "argument" }}</p>
            </div>
            <div class="col-2 column">
              <p class="font-semibold"> {{ i18n "type" }}</p>
            </div>
            <div class="col-3 column">
              <p class="font-semibold"> {{ i18n "description" }}</p>
            </div>
            <div class="col-2 column">
              <p class="font-semibold"> {{ i18n "default" | default "default" }}</p>
            </div>
            <div class="col-2 column">
              <p class="font-semibold"> {{ i18n "required" | default "required" }}</p>
            </div>
          </div>
          <div class="row">
          {{ range . }}

            <div class="col-12 first-column">
              <div class="row first-row ">
                  <div class="col-2 column">
                      <p> {{ .name | default "" }}</p>
                  </div>
                  <div class="col-2 column">
                      <p> {{ delimit .type ", " | default "" }}</p>
                  </div>
                  <div class="col-3 column">
                      <p> {{ .description | default "" | markdownify }}</p>
                  </div>
                  <div class="col-2 column">
                      <p> {{ .default | default "" }}</p>
                  </div>
                  <div class="col-2 column">
                      <p> {{ .required | default "" }}</p>
                  </div>
              </div>
            </div>

          {{ end }}
            </div>
        </div>
      </div>
    {{ end }}
    {{ with $obj.internal_failure_reasons }}
      <h4 id="{{ $obj.name | anchorize }}-errors">Errors</h4>
      <ul>
      {{ range $reason := . }}
        <li>{{ . | markdownify }}</li>
      {{ end }}
      </ul>
    {{ end }}
    {{ with $obj.examples }}
      <h4 id="{{ $obj.name | anchorize }}-examples">Examples</h4>
      <div>
        <div class="card-body">
          {{ range $i, $ex := . }}
            <h3 id="{{ $ex.title | anchorize }}">{{ $ex.title | markdownify }}</h3>
            <p>Source:</p>
            {{ print "```bash\n" $ex.source "\n```" | markdownify }}
            <p>Return:</p>
            {{ highlight $ex.return "bash" }}
          {{ end }}
        </div>
      </div>
    {{ end }}
  </div>
  {{ end }}
{{ end }}
